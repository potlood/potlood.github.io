!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Potlood=e():t.Potlood=e()}(this,(function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";var s,r,a,n,o,h,d,c,l,u,g,p,m,b,_,f,w,v,S,y,k,x,N,T,C,P,A;i.r(e),i.d(e,"Potlood",(function(){return ze})),function(t){t[t.Middle=0]="Middle",t[t.First=1]="First",t[t.Last=2]="Last",t[t.Only=3]="Only",t[t.Special=4]="Special"}(s||(s={}));class D{constructor(t,e){this.x=t,this.y=e}static difference(t,e){return new D(t.x-e.x,t.y-e.y)}translate(t){return new D(this.x+t.x,this.y+t.y)}scale(t){let e,i;return t instanceof D?(e=t.x,i=t.y):(e=t,i=t),new D(this.x*e,this.y*i)}toString(){return`(${this.x}, ${this.y})`}clone(){return new D(this.x,this.y)}}class L{constructor(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get topLeft(){return new D(this.left,this.top)}get topRight(){return new D(this.right,this.top)}get bottomLeft(){return new D(this.left,this.bottom)}get bottomRight(){return new D(this.right,this.bottom)}translate(t,e){return new L(this.x+t,this.y+e,this.width,this.height)}addBorder(t,e,i,s){return new L(this.x-t,this.y-e,this.width+t+i,this.height+e+s)}addBordersAndMargins(t,e,i,s){const r=(void 0!==t.borderStart?t.borderStart.size:0)+e.cellMarginStart,a=(void 0!==t.borderEnd?t.borderEnd.size:0)+e.cellMarginEnd,n=(void 0!==t.borderTop?t.borderTop.size:0)+e.cellMarginTop,o=(void 0!==t.borderBottom?t.borderBottom.size:0)+e.cellMarginBottom;return this.addBorder(r,n,a,o)}addSpacing(t){return this.addBorder(t,t,t,t)}subtractBorder(t,e,i,s){return new L(this.x+t,this.y+e,this.width-t-i,this.height-e-s)}subtractBordersAndMargins(t,e,i,s){const r=(void 0!==t.borderStart?t.borderStart.size:0)+e.cellMarginStart,a=(void 0!==t.borderEnd?t.borderEnd.size:0)+e.cellMarginEnd,n=(void 0!==t.borderTop?t.borderTop.size:0)+e.cellMarginTop,o=(void 0!==t.borderBottom?t.borderBottom.size:0)+e.cellMarginBottom;return this.subtractBorder(r,n,a,o)}subtractSpacing(t){return this.subtractBorder(t,t,t,t)}includePoint(t,e){const i=t instanceof D?t.x:t,s=t instanceof D?t.y:e,r=Math.min(this.x,i),a=Math.min(this.y,s),n=Math.max(this.x+this.width,i+this.width)-r,o=Math.min(this.y+this.height,s+this.height)-a;return new L(r,a,n,o)}placeInRectangle(t,e,i,r){let a=0,n=0;return i===s.Middle?a=this.x+this.width/2-t/2:i===s.Last&&(a=this.right-t),r===s.Middle?n=this.y+this.height/2-e/2:i===s.Last&&(n=this.bottom-e),new L(a,n,t,e)}addOnTopOf(t,e=0){const i=Math.max(this.width,t.width),s=this.height+t.height+e;return new L(this.x,this.y,i,s)}addInFrontOf(t,e=0){const i=this.width+t.width+e,s=Math.max(this.height,t.height);return new L(this.x,this.y,i,s)}intersectX(t){return this.left<=t&&this.right>=t}intersectY(t){return this.top<=t&&this.bottom>=t}intersectPoint(t){return this.intersectX(t.x)&&this.intersectY(t.y)}clone(){return new L(this.x,this.y,this.width,this.height)}toString(){return`{${this.x}, ${this.y}, ${this.width}, ${this.height}}`}}!function(t){t[t.Inline=0]="Inline",t[t.Floating=1]="Floating"}(r||(r={})),function(t){t[t.None=0]="None",t[t.Character=1]="Character",t[t.Column=2]="Column",t[t.EndMargin=3]="EndMargin",t[t.InsideMargin=4]="InsideMargin",t[t.Margin=5]="Margin",t[t.OutsideMargin=6]="OutsideMargin",t[t.Page=7]="Page",t[t.Paragraph=8]="Paragraph",t[t.StartMargin=9]="StartMargin"}(a||(a={})),function(t){t[t.End=0]="End",t[t.Center=1]="Center",t[t.Inside=2]="Inside",t[t.Outside=3]="Outside",t[t.Start=4]="Start"}(n||(n={}));class M{constructor(){this.offsetX=0,this.offsetY=0,this.referenceX=a.None,this.referenceY=a.None,this.referenceOffsetX=0,this.referenceOffsetY=0,this.alignX=n.Start,this.alignY=n.Start,this.sizeX=0,this.sizeY=0,this.flipHorizontal=!1,this.flipVertical=!1,this.rotation=0,this.anchor=r.Inline}getBox(t){const e=this._getStartPoint(t);return new L(e.x,e.y,this.sizeX,this.sizeY)}_getStartPoint(t){let e=t.getReferenceX(this.referenceX,this.sizeX),i=t.getReferenceY(this.referenceY);switch(this.referenceX){case a.None:e+=this.offsetX;break;case a.Column:default:e+=this.referenceOffsetX}switch(this.referenceY){case a.None:i+=this.offsetY;break;case a.Paragraph:default:i+=this.referenceOffsetY}return new D(e,i)}}class F{constructor(t,e=!1){this.bounds=t,this.isFloating=e}}class E{constructor(t,e,i=0){this._lastParPos=0,this._lastCharX=0,this._stops=[],this._nums={},this._obstacles=[],this._xMin=t,this._xMax=e,this._pos=i}static fromSection(t){const e=new E(40,660);if(void 0!==t){let i=700;void 0!==t.pageWidth&&(i=t.pageWidth);t.pageHeight;const s=t.marginLeft;void 0!==s&&(e._xMin=s);const r=t.marginRight;void 0!==r&&(e._xMax=i-r)}return e}getX(t=0){let e=this._xMin;const i=this._getApplicableObstacle();if(void 0!==i){i.bounds.width>=this._xMax-this._xMin-t?this.advancePosition(i.bounds.height):e=i.bounds.right}return e}getReferenceX(t,e){let i=this.getX(e);switch(t){case a.Character:i=this._lastCharX;break;case a.None:case a.Column:default:i=this._xMin}return i}getY(){return this._pos}getMaxY(t){let e=this._pos;return this._obstacles.forEach(i=>{(!i.isFloating||t&&i.isFloating)&&(e=Math.max(e,i.bounds.bottom))}),e}getReferenceY(t){let e=this._pos;switch(t){case a.Paragraph:e=this._lastParPos;break;default:e=this._pos}return e}getWidth(){let t=this._xMax-this._xMin;const e=this._getApplicableObstacle();return void 0!==e&&(t-=e.bounds.width),t}addObstacle(t,e){this._obstacles.push(new F(t,e))}copyObstaclesFrom(t){t._obstacles.forEach(t=>this.addObstacle(t.bounds,t.isFloating))}advanceX(t,e){return this._xMin+=t,this._xMax-=t-e,this}advancePosition(t){return this._pos+=t,this}advanceNumbering(t,e){const i=`${t}-${e}`,s=this._nums[i];this._nums[i]=void 0===s?2:s+1}getNumbering(t,e){const i=`${t}-${e}`;return this._nums[i]||1}getTab(t){return this._stops[t]}addTabStop(t){this._stops.push(t)}removeTabStop(){this._stops.pop()}mentionParagraphPosition(){this._lastParPos=this._pos}mentionCharacterPosition(t){this._lastCharX=this._xMin+t}clone(){const t=new E(this._xMin,this._xMax,this._pos);return t._stops=this._stops,t._nums=this._nums,t._obstacles=this._obstacles,t}_getApplicableObstacle(){let t=void 0;for(let e=0;e<this._obstacles.length;e++)if(this._obstacles[e].bounds.intersectY(this._pos)){t=this._obstacles[e];break}return t}}class V{static convertTwipsToPixels(t){return t/15}static convertPointToPixels(t){return V.convertTwipsToPixels(20*t)}static convertEmuToPixels(t){return V.convertPointToPixels(t/12700)}static convertPointToFontSize(t){return 46*t/72}static convertRotationToRadians(t){return t*Math.PI/108e5}static getTextWidth(t,e){return this.getTextWidthFromCanvas(t,e)}static getTextWidthFromSvg(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("font-family",e.fontFamily),i.setAttribute("font-size",""+e.fontSize),e.bold&&i.setAttribute("font-weight","bold"),e.italic&&i.setAttribute("font-style","italic");const s=document.createTextNode(t);i.appendChild(s),this.svg.appendChild(i);const r=i.getComputedTextLength();return this.svg.removeChild(i),r}static getTextWidthFromCanvas(t,e){return this.getTextMetrics(t,e).width}static getTextMetrics(t,e){const i=e.italic?"italic ":"",s=e.bold?"bold ":"";return this.context.font=i+s+Math.round(e.fontSize)+"px "+e.fontFamily,this.context.measureText(t)}static init(){void 0===this.canvas&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("width","1000"),this.svg.setAttribute("height","240"),this.svg.setAttribute("visibility","hidden"),document.body.appendChild(this.svg))}}class B{static loadFromUrl(t){return new Promise((e,i)=>{var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="text",s.onload=r=>{if(200===s.status){var a=s.response;const t=(new DOMParser).parseFromString(a,"application/xml");e(t)}else i("File not found: "+t)},s.onerror=t=>{i(t)},s.send(null)})}static getAttribute(t,e){let i=void 0;const s=t.getAttribute(e);return null!==s&&(i=s),i}static getFirstChildOfName(t,e){if(!Array.isArray(e))return this.getFirstChildOfName(t,[e]);let i=void 0;const s=t.childNodes;for(let t=0;t<s.length;t++)if(-1!==e.indexOf(s[t].nodeName)){i=s[t];break}return i}static getStringValue(t){let e=void 0,i=B.getAttribute(t,"w:val");return void 0!==i?e=i:(i=B.getAttribute(t,"val"),void 0!==i?e=i:(i=B.getAttribute(t,"m:val"),void 0!==i&&(e=i))),e}static getStringValueFromNode(t,e){let i=void 0;const s=B.getFirstChildOfName(t,e);return void 0!==s&&(i=B.getStringValue(s)),i}static getBooleanValue(t){let e=void 0;const i=B.getStringValue(t);return e=void 0===i||B.attributeAsBoolean(i),e}static getBooleanValueFromNode(t,e){let i=void 0;const s=B.getFirstChildOfName(t,e);return void 0!==s&&(i=B.getBooleanValue(s)),i}static getNumberValue(t){let e=void 0;const i=B.getStringValue(t);return void 0!==i&&(e=parseFloat(i)),e}static getNumberValueFromNode(t,e){let i=void 0;const s=B.getFirstChildOfName(t,e);return void 0!==s&&(i=B.getNumberValue(s)),i}static attributeAsBoolean(t){return"true"===t||"1"===t}}class R{constructor(t,e){this.numId=t,this._levelIndex=e}static fromNumPresentationNode(t){let e=void 0;if(t){const i=B.getStringValueFromNode(t,"w:ilvl"),s=B.getStringValueFromNode(t,"w:numId");if(void 0!==i&&void 0!==s){const t=parseInt(i),r=parseInt(s);e=new R(r,t)}}return e}getPrefixText(t){return this.level?this.level.getText(t):""}get style(){let t=void 0;return void 0!==this.level&&(t=this.level.style),t}applyNumberings(t){if(void 0!==t){const e=t.getNumberingById(this.numId);void 0!==e?this.level=e.getLevel(this._levelIndex):console.log("Could not find numbering ID "+this.numId)}}}!function(t){t[t.None=0]="None",t[t.Dot=1]="Dot"}(o||(o={})),function(t){t[t.Clear=0]="Clear",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Center=3]="Center",t[t.Numbering=4]="Numbering"}(h||(h={}));class O{constructor(t,e,i){this.position=void 0,this.leader=o.None,this._pos=t,this._alignment=e,this.leader=i}static fromTabsNode(t){const e=[];return t.childNodes.forEach(t=>{const i=B.getStringValue(t),s=B.getAttribute(t,"w:leader"),r=B.getAttribute(t,"w:pos");if(void 0!==i&&void 0!==r){const t=this._readTabAlignment(i),a=this._readTabLeader(s),n=V.convertTwipsToPixels(parseInt(r)),o=new O(n,t,a);e.push(o)}}),e}static _readTabAlignment(t){let e=h.Left;switch(t.toLowerCase()){case"num":e=h.Numbering;break;case"center":e=h.Center;break;case"clear":e=h.Clear;break;case"left":e=h.Left;break;case"right":case"decimal":e=h.Right;break;default:console.log("Unknown tab alignment value encountered: "+t)}return e}static _readTabLeader(t){let e=o.None;if(void 0!==t)switch(t.toLowerCase()){case"dot":e=o.Dot}return e}get isClear(){return this._alignment===h.Clear}get justification(){let t=c.left;return this._alignment===h.Center?t=c.center:this._alignment===h.Right&&(t=c.right),t}performLayout(t){this._alignment!==h.Clear&&(this.position=t.getX()+this._pos)}}!function(t){t[t.None=0]="None",t[t.Dash=1]="Dash",t[t.DashDotDotHeavy=2]="DashDotDotHeavy",t[t.DashDotHeavy=3]="DashDotHeavy",t[t.DashedHeavy=4]="DashedHeavy",t[t.DashLong=5]="DashLong",t[t.DashLongHeavy=6]="DashLongHeavy",t[t.DotDash=7]="DotDash",t[t.DotDotDash=8]="DotDotDash",t[t.Dotted=9]="Dotted",t[t.DottedHeavy=10]="DottedHeavy",t[t.Double=11]="Double",t[t.Single=12]="Single",t[t.Thick=13]="Thick",t[t.Wave=14]="Wave",t[t.WavyDouble=15]="WavyDouble",t[t.WavyHeavy=16]="WavyHeavy",t[t.Words=17]="Words"}(d||(d={}));class z{static fromPresentationNode(t){const e=new z;return t.childNodes.forEach(t=>{switch(t.nodeName){case"w:rStyle":e._basedOnId=B.getStringValue(t);break;case"w:b":e._bold=B.getBooleanValue(t);break;case"w:i":e._italic=B.getBooleanValue(t);break;case"w:shd":e._shadingColor=$.readShading(t);break;case"w:highlight":e._shadingColor="ffff00";break;case"w:u":const i=B.getStringValue(t);void 0!==i&&(e._underlineMode=z.readUnderlineMode(i));break;case"w:strike":e._strike=B.getBooleanValue(t);break;case"w:dstrike":e._dstrike=B.getBooleanValue(t);break;case"w:rFonts":const s=z.readFontFamily(t);e._fontFamily=void 0!==s?s[j.tryAddFonts(s)]:void 0;break;case"w:sz":e._fontSize=z.readFontSize(t);break;case"w:spacing":const r=B.getNumberValue(t);void 0!==r&&(e._charSpacing=V.convertTwipsToPixels(r));break;case"w:w":const a=B.getNumberValue(t);void 0!==a&&(e._charStretch=a/100);break;case"w:color":e._color=B.getStringValue(t);break;case"w:caps":e._caps=B.getBooleanValue(t);break;case"w:smallCaps":e._smallCaps=B.getBooleanValue(t);break;case"w:webHidden":case"w:vanish":e._invisible=!0;break;case"w:shadow":case"w:outline":case"w:position":case"w:vertAlign":case"w:em":break;case"w:szCs":case"w:iCs":case"w:bCs":case"w:lang":case"w:kern":break;default:console.log(`Don't know how to parse ${t.nodeName} during RunStyle reading.`)}}),e}get parent(){return this._basedOn||this._docDefaults}applyNamedStyles(t){if(void 0!==t&&(this._docDefaults=t.docDefaults,void 0!==this._basedOnId)){const e=t.getNamedStyle(this._basedOnId);void 0!==e&&(this._basedOn=e)}}updateFont(t,e,i){this._fontFamily=t,this._bold=e,this._fontSize=i}toString(){return`RunStyle: ${void 0!==this._italic?"i="+this._italic:""} ${void 0!==this._bold?"b="+this._bold.toString():""} ${void 0!==this._underlineMode?"u="+this._underlineMode.toString():""} ${void 0!==this._strike?"strike="+this._strike.toString():""} ${void 0!==this._fontFamily?"font="+this._fontFamily.toString():""} ${void 0!==this._fontSize?"size="+this._fontSize.toString():""} ${void 0!==this._dstrike?"dstrike="+this._dstrike.toString():""} ${void 0!==this._charSpacing?"char_spacing="+this._charSpacing.toString():""} ${void 0!==this._charStretch?"char_stretch="+this._charStretch.toString():""} ${void 0!==this._color?"color="+this._color.toString():""} ${void 0!==this._caps?"caps="+this._caps.toString():""} ${void 0!==this._smallCaps?"smallcaps="+this._smallCaps.toString():""}`}static readFontFamily(t){let e=void 0;const i=B.getAttribute(t,"w:ascii");return void 0!==i&&(e=i.split(";")),e}static readFontSize(t){const e=B.getNumberValue(t);return void 0!==e?V.convertPointToFontSize(e):void 0}static readUnderlineMode(t){let e;switch(t){case"dash":e=d.Dash;break;case"dashDotDotHeavy":e=d.DashDotDotHeavy;break;case"dashDotHeavy":e=d.DashDotHeavy;break;case"dashedHeavy":e=d.DashedHeavy;break;case"dashLong":e=d.DashLong;break;case"dashLongHeavy":e=d.DashLongHeavy;break;case"dotDash":e=d.DotDash;break;case"dotDotDash":e=d.DotDotDash;break;case"dotted":e=d.Dotted;break;case"dottedHeavy":e=d.DottedHeavy;break;case"double":e=d.Double;break;case"single":e=d.Single;break;case"thick":e=d.Thick;break;case"wave":e=d.Wave;break;case"wavyDouble":e=d.WavyDouble;break;case"wavyHeavy":e=d.WavyHeavy;break;case"words":e=d.Words;break;case"none":default:e=d.None}return e}}!function(t){t.center="center",t.both="both",t.left="left",t.right="right"}(c||(c={})),function(t){t.exactly="exactly",t.atLeast="atLeast",t.auto="auto"}(l||(l={}));class I{constructor(){this.justification=void 0}static fromParPresentationNode(t){const e=new I;return t.childNodes.forEach(t=>{switch(t.nodeName){case"w:pStyle":e._basedOnId=B.getStringValue(t);break;case"w:jc":const i=B.getStringValue(t);void 0!==i&&(e.justification=c[i]);break;case"w:ind":const s=B.getAttribute(t,"w:hanging");void 0!==s&&(e.hanging=V.convertTwipsToPixels(parseInt(s,10)));const r=B.getAttribute(t,"w:left");void 0!==r&&(e.indentation=V.convertTwipsToPixels(parseInt(r,10)));break;case"w:numPr":e.numStyle=R.fromNumPresentationNode(t);break;case"w:spacing":e.setLineSpacingFromNode(t),e.setParSpacingFromNode(t);break;case"w:shd":e.shadingColor=$.readShading(t);break;case"w:tabs":e.tabStops=O.fromTabsNode(t);break;case"w:rPr":e.runStyle=z.fromPresentationNode(t);break;case"w:widowControl":case"w:snapToGrid":case"w:sectPr":case"w:pBdr":case"w:contextualSpacing":case"w:keepLines":case"w:bidi":case"w:keepNext":case"w:suppressAutoHyphens":case"w:suppressLineNumbers":case"w:outlineLvl":break;default:console.log(`Don't know how to parse ${t.nodeName} during ParStyle reading.`)}}),e}get parent(){return this._basedOn||this._docDefaults}getLineSpacing(t){let e=this._lineSpacing;if(void 0!==e){switch(this._lineRule){case l.auto:e=1.08*t.fontSize*e/240;break;default:e=V.convertTwipsToPixels(e)}}return e}setLineSpacing(t){this._lineSpacing=t,this._lineRule=l.atLeast}get spacingBefore(){let t=0;return void 0!==this._parLinesBefore&&void 0!==this._lineSpacing?t=this._parLinesBefore*this._lineSpacing:void 0!==this._parSpacingBefore?t=this._parSpacingBefore:!0===this._parAutoSpacingBefore&&void 0!==this._lineSpacing&&(t=1.08*this._lineSpacing),t}get spacingAfter(){let t=0;return void 0!==this._parLinesAfter&&void 0!==this._lineSpacing?t=this._parLinesAfter*this._lineSpacing:void 0!==this._parSpacingAfter?t=this._parSpacingAfter:!0===this._parAutoSpacingAfter&&void 0!==this._lineSpacing&&(t=1.08*this._lineSpacing),t}applyNamedStyles(t){if(void 0!==t&&(this._docDefaults=t.docDefaults,void 0!==this._basedOnId)){const e=t.getNamedStyle(this._basedOnId);void 0!==e&&(this._basedOn=e)}}applyNumberings(t){void 0!==this.numStyle&&this.numStyle.applyNumberings(t)}clone(){const t=new I;return t._docDefaults=this._docDefaults,t._basedOn=this._basedOn,t._basedOnId=this._basedOnId,t.justification=this.justification,t.indentation=this.indentation,t.hanging=this.hanging,t._lineSpacing=this._lineSpacing,t._lineRule=this._lineRule,t.numStyle=this.numStyle,t.shadingColor=this.shadingColor,t._parSpacingBefore=this._parSpacingBefore,t._parSpacingAfter=this._parSpacingAfter,t._parLinesBefore=this._parLinesBefore,t._parLinesAfter=this._parLinesAfter,t._parAutoSpacingBefore=this._parAutoSpacingBefore,t._parAutoSpacingAfter=this._parAutoSpacingAfter,t.tabStops=this.tabStops,t}toString(){return`ParStyle: ${void 0!==this._basedOnId?"base="+this._basedOnId:""} ${void 0!==this.justification?"jc="+this.justification.toString():""} ${void 0!==this.indentation?"ind="+this.indentation.toString():""} ${void 0!==this._lineSpacing?"line="+this._lineSpacing.toString():""}`}setLineSpacingFromNode(t){const e=B.getAttribute(t,"w:line");void 0!==e&&(this._lineSpacing=parseInt(e,10),this._lineRule=l.exactly);const i=B.getAttribute(t,"w:lineRule");void 0!==i&&(this._lineRule=l[i])}setParSpacingFromNode(t){const e=B.getAttribute(t,"w:before");void 0!==e&&(this._parSpacingBefore=V.convertTwipsToPixels(parseInt(e,10)));const i=B.getAttribute(t,"w:beforeLines");void 0!==i&&(this._parLinesBefore=parseInt(i,10)/100);const s=B.getAttribute(t,"w:beforeAutospacing");void 0!==s&&(this._parAutoSpacingBefore=B.attributeAsBoolean(s));const r=B.getAttribute(t,"w:after");void 0!==r&&(this._parSpacingAfter=V.convertTwipsToPixels(parseInt(r,10)));const a=B.getAttribute(t,"w:afterLines");void 0!==a&&(this._parLinesAfter=parseInt(a,10)/100);const n=B.getAttribute(t,"w:afterAutospacing");void 0!==n&&(this._parAutoSpacingAfter=B.attributeAsBoolean(n))}}!function(t){t[t.Normal=0]="Normal",t[t.Bold=1]="Bold",t[t.Italic=2]="Italic",t[t.SmallCaps=4]="SmallCaps"}(u||(u={}));class ${constructor(t,e){this.parStyle=void 0!==t?t:new I,this.runStyle=void 0!==e?e:new z}static fromDocDefaultsNode(t){let e=void 0,i=void 0;const s=B.getFirstChildOfName(t,"w:rPrDefault");if(void 0!==s){const t=B.getFirstChildOfName(s,"w:rPr");void 0!==t&&(i=z.fromPresentationNode(t))}const r=B.getFirstChildOfName(t,"w:pPrDefault");if(void 0!==r){const t=B.getFirstChildOfName(r,"w:pPr");void 0!==t&&(e=I.fromParPresentationNode(t))}return new $(e,i)}static fromStyleNode(t){let e=void 0,i=void 0,s=void 0;t.childNodes.forEach(t=>{switch(t.nodeName){case"w:pPr":e=I.fromParPresentationNode(t);break;case"w:rPr":i=z.fromPresentationNode(t);break;case"w:basedOn":s=B.getStringValue(t);break;case"w:name":case"w:aliases":case"w:autoRedefine":case"w:qFormat":case"w:semiHidden":case"w:uiPriority":case"w:unhideWhenUsed":case"w:rsid":case"w:locked":case"w:lsdException":case"w:personal":case"w:personalCompose":case"w:personalReply":break;case"w:start":case"w:lvlText":case"w:lvlJc":case"w:numFmt":case"w:suff":break;case"w:next":case"w:link":case"w:tblPr":case"w:hidden":case"w:latentStyles":case"w:pStyle":break;default:console.log(`Don't know how to parse ${t.nodeName} during Style reading.`)}});const r=new $(e,i);return r._basedOnId=s,r}static readShading(t){let e=void 0;const i=B.getAttribute(t,"w:fill");return void 0!==i&&(e=i),e}applyNamedStyles(t){if(void 0!==this._basedOnId&&void 0!==t){const e=t.getNamedStyle(this._basedOnId);void 0!==e&&(this._basedOn=e)}void 0!==this.runStyle&&this.runStyle.applyNamedStyles(t),void 0!==this.parStyle&&this.parStyle.applyNamedStyles(t)}get italic(){return this.getValue(!1,void 0,t=>t._italic)}get bold(){return this.getValue(!1,void 0,t=>t._bold)}get underlineMode(){return this.getValue(d.None,void 0,t=>t._underlineMode)}get strike(){return this.getValue(!1,void 0,t=>t._strike)}get doubleStrike(){return this.getValue(!1,void 0,t=>t._dstrike)}get fontFamily(){return this.getValue("Arial",void 0,t=>t._fontFamily)}get fontSize(){return this.getValue(12,void 0,t=>t._fontSize)}get charSpacing(){return this.getValue(0,void 0,t=>t._charSpacing)}get charStretch(){return this.getValue(1,void 0,t=>t._charStretch)}get lineSpacing(){const t=this;let e=this.getValue(void 0,e=>e.getLineSpacing(t),void 0);return void 0===e&&(e=1.08*this.fontSize),e}get shadingColor(){return this.getValue("000000",t=>t.shadingColor,t=>t._shadingColor)}getIndentation(t,e){let i=this.getValue(0,t=>t.indentation,void 0);if(!(e!==s.First&&e!==s.Only||t!==s.First&&t!==s.Only)){const t=this.getValue(void 0,t=>t.hanging,void 0);void 0!==t&&(i-=t)}return i}get caps(){return this.getValue(!1,void 0,t=>t._caps)}get smallCaps(){return this.getValue(!1,void 0,t=>t._smallCaps)}get color(){return this.getValue("000000",void 0,t=>t._color)}get justification(){return this.getValue(c.left,t=>t.justification,void 0)}get invisible(){return this.getValue(!1,void 0,t=>t._invisible)}get emphasis(){let t=u.Normal;return this.bold&&(t|=u.Bold),this.italic&&(t|=u.Italic),this.smallCaps&&(t|=u.SmallCaps),t}get font(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+Math.round(this.fontSize)+"px "+this.fontFamily}toString(){return`Style: ${void 0!==this._basedOnId?"base="+this._basedOnId:""} ${"jc="+this.justification.toString()} ${"ind="+this.getIndentation(s.First,s.First).toString()} ${"ind="+this.getIndentation(s.Middle,s.Middle).toString()} ${"i="+this.italic} ${"b="+this.bold.toString()} ${"u="+this.underlineMode.toString()} ${"strike="+this.strike.toString()} ${"font="+this.fontFamily.toString()} ${"size="+this.fontSize.toString()} ${"dstrike="+this.doubleStrike.toString()} ${"char_spacing="+this.charSpacing.toString()} ${"line_spacing="+this.lineSpacing.toString()} ${"color="+this.color.toString()} ${"caps="+this.caps.toString()} ${"smallcaps="+this.smallCaps.toString()}`}getValue(t,e,i){let s=this.getRecursive(e,i);return void 0===s&&(s=t),s}getRecursive(t,e,i){let s=void 0;if(void 0!==this.runStyle){if(void 0!==e){const t=e(this.runStyle);void 0!==t&&(s=t)}const i=this.runStyle.parent;void 0===s&&void 0!==i&&(s=i.getRecursive(t,e))}if(void 0===s&&void 0!==this.parStyle){if(void 0!==t){const e=t(this.parStyle);void 0!==e&&(s=e)}const i=this.parStyle.runStyle;if(void 0===s&&void 0!==e&&void 0!==i&&(s=e(i)),void 0===s&&void 0!==this.parStyle.numStyle){const i=this.parStyle.numStyle.style;void 0!==i&&(s=i.getRecursive(t,e))}const r=this.parStyle.parent;void 0===s&&void 0!==r&&(s=r.getRecursive(t,e))}if(void 0===s&&void 0!==this.tableStyle&&void 0!==i){const t=i(this.tableStyle);void 0!==t&&(s=t)}if(void 0===s){const i=this._basedOn;void 0!==i&&(s=i.getRecursive(t,e))}return s}}class j{static availableFonts(){if(!j._initialized){j._initialized=!0;const t=["Arial","Helvetica","Times","Courier","Verdana","Georgia","Garamond","Comic Sans MS","Trebuchet MS","Arial Black","Impact"],e=new $;e.runStyle.updateFont("Times New Roman",!1,j.testSize),j.baseline=V.getTextWidth(j.testString,e)/j.testString.length,j._foundFonts["Times New Roman"]=j.baseline,t.forEach(t=>{j.testFont(t,!1)})}return j._foundFonts}static tryAddFonts(t){for(let e=0;e<t.length;e++)if(this.tryAddFont(t[e],!1))return e;return-1}static tryAddFont(t,e){const i=j._getName(t,e);if(!(void 0!==j.availableFonts()[i])){return!(void 0!==j._notFoundFonts[i])&&j.testFont(t,e)}return!0}static testFont(t,e){const i=new $;i.runStyle.updateFont(t,e,j.testSize);const s=j._getName(t,e),r=V.getTextWidth(j.testString,i)/j.testString.length;return r!==j.baseline?(j._foundFonts[s]=r,!0):(j._notFoundFonts[s]=r,!1)}static _getName(t,e){return t+(e?"-bold":"")}}j._initialized=!1,j._foundFonts={},j._notFoundFonts={},j.testString="mmmmmllnnrr",j.testSize=72,j.baseline=void 0;class X{static fitCharacters(t,e){const i=X.averageCharWidth(e);return Math.floor(t/i)}static averageCharWidth(t){const e=t.fontSize,i=t.fontFamily;return j.tryAddFont(i,t.bold),this.getFontMetrics(t).width/this._testString.length*e/this._testSize}static getTotalHeight(t){const e=this.getFontMetrics(t);return(e.fontBoundingBoxAscent+e.fontBoundingBoxDescent)*t.fontSize/this._testSize}static getTopToBaseline(t){return(this.getFontMetrics(t).fontBoundingBoxAscent||this._testSize*X._topToBaseFactor)*t.fontSize/this._testSize}static getBaselineToBottom(t){const e=this.getFontMetrics(t),i=1-X._topToBaseFactor;return(e.fontBoundingBoxDescent||this._testSize*i)*t.fontSize/this._testSize}static getFontMetrics(t){const e=t.fontFamily+t.bold?"-bold":"";let i=X._fonts[e];if(void 0===i){const e=new $;e.runStyle.updateFont(t.fontFamily,t.bold,this._testSize),i=V.getTextMetrics(X._testString,e)}return i}}X._fonts={},X._testString="The quick brown fox jumped over the fence",X._testSize=72,X._topToBaseFactor=13/16,function(t){t[t.Space=0]="Space",t[t.Dash=1]="Dash",t[t.Tab=2]="Tab",t[t.LineFeed=3]="LineFeed"}(g||(g={}));class G{constructor(t){this._texts=t}get words(){return void 0===this._words&&this._split(),this._words||[]}getSeperator(t){return void 0===this._words&&this._split(),this._seperators[t]}combine(t,e){const i=[];void 0===this._words&&this._split();const s=this._words;for(let r=t;r<=e;r++){switch(i.push(s[r]),this.getSeperator(r)){case g.Dash:i.push("-");break;case g.Tab:break;default:i.push(" ")}}return i.join("")}_split(){const t=this._texts.join("");this._words=t.split(/[\s-\t]/);const e=[];let i=0;for(let s=1;s<this._words.length;s++){switch(i+=this._words[s-1].length,t.charAt(i)){case" ":e.push(g.Space);break;case"-":e.push(g.Dash);break;case"\t":e.push(g.Tab);break;case"\r":case"\n":e.push(g.LineFeed);break;default:console.log("Invalid seperator character found, assuming a space."),e.push(g.Space)}i++}this._seperators=e}}class H{constructor(t){this.lastXPadding=0,this._run=t,this._lineHeight=this._run.style.lineSpacing,this.lines=[]}getFlowLines(t){let e=s.First,i=this._getInitialXPadding(),r=this._isFollowing;if(this._run.hasEmptyText)return void(this.lastXPadding=i);this._fixYPosition(r,t);const a=this._fixAllCaps(this._run.texts),n=new G(a),o=n.words;if(1===this._run.texts.length&&" "===this._run.texts[0])return void(this.lastXPadding=i+X.averageCharWidth(this._run.style));const h=this._run.paragraphType===p.TableCell;let d=0,c=0,l=0,u=this._getAvailableChars(i,t),m=!1,b=this._run.style.justification;for(let a=0;a<o.length;a++){l+=o[a].length+1,m=a===o.length-1;const p=n.getSeperator(a),_=p===g.LineFeed,f=p===g.Tab;let w=m||_||f;w||this._fitReasonably(l,u,h,o[a+1])||(w=!0),w&&(e=m?s.Last:e,this._pushNewLine(n.combine(c,a),t,r,f,e,i,b,this._run.style),m||(r=!1,e=s.Middle,f?(i=this._getTabPadding(d,t),b=this._getTabJustification(d,this._run.style,t),d++):(i=this._getIndentation(e),d=0),u=this._getAvailableChars(i,t),l=0,c=a+1))}this.lastXPadding=this._finalXPadding(i,t)}get _isFirstRun(){return this._run.inParagraph===s.First||this._run.inParagraph===s.Only}get _isLastRun(){return this._run.inParagraph===s.Last||this._run.inParagraph===s.Only}_pushNewLine(t,e,i,r,a,n,o,h){const d=a===s.Last||a===s.Only,l=this._run.inParagraph===s.Last||this._run.inParagraph===s.Only,u=h.justification===c.both&&!d;this.lines.push({text:t,x:e.getX()+n,y:e.getY(),width:e.getWidth()-n,stretched:u,following:i,color:h.color,fontFamily:h.fontFamily,fontSize:h.fontSize,emphasis:h.emphasis,justification:o}),r||!l&&d||e.advancePosition(this._lineHeight)}_fixAllCaps(t){return(this._run.style.caps||this._run.style.smallCaps)&&(t=t.map(t=>t.toLocaleUpperCase())),t}_fixYPosition(t,e){t||e.advancePosition(X.getTopToBaseline(this._run.style))}get _isFollowing(){let t;return t=void 0!==this._run.previousXPos&&!this._isFirstRun,t}_getIndentation(t){return this._run.style.getIndentation(t,this._run.inParagraph)}_getTabPadding(t,e){let i=0;const s=e.getTab(t);return void 0!==s&&void 0!==s.position&&(i=s.position),i}_getTabJustification(t,e,i){let s=e.justification;const r=i.getTab(t);return void 0!==r&&(s=r.justification),s}_getAvailableChars(t,e){return X.fitCharacters(e.getWidth()-t,this._run.style)}_fitReasonably(t,e,i,s){if(void 0===s)return!0;const r=i?0:1;return t+s.length<=e+r}_getInitialXPadding(){let t=0;return t=void 0===this._run.previousXPos||this._isFirstRun?this._getIndentation(s.First):this._run.previousXPos,t}_finalXPadding(t,e){return this._isLastRun&&e.advancePosition(X.getBaselineToBottom(this._run.style)),t+V.getTextWidth(this.lines[this.lines.length-1].text,this._run.style)}}class W{constructor(t,e){this.width=t,this.height=e}addVertical(t,e=0){const i=Math.max(this.width,t.width),s=this.height+t.height+e;return new W(i,s)}addHorizontal(t,e=0){const i=this.width+t.width+e,s=Math.max(this.height,t.height);return new W(i,s)}clone(){return new W(this.width,this.height)}}class U{constructor(t,e){this.inParagraph=s.Only,this.paragraphType=p.Text,this.linkTarget=void 0,this.lastXPos=0,this._lines=void 0,this.style=e,this.texts=t}getSize(){return new W(this.getUsedWidth(),this.getHeight())}getUsedWidth(){let t=0;return this.getLines().forEach(e=>t=Math.max(t,e.width)),t}getWidthOfLastLine(){const t=this.getLines();return V.getTextWidth(t[t.length-1].text,this.style)}getHeight(){return this.getLines().length*this.style.lineSpacing}getLines(){let t;if(void 0===this._lines)throw new Error("Rendering text which hasn't been included in layout");return t=this._lines,t}get hasEmptyText(){return 0===this.texts.length}performLayout(t){void 0===this._lines&&(this._lines=this._getFlowLines(t))}_getFlowLines(t){let e=[];if(this.style.invisible)this.lastXPos=0;else{const i=new H(this);i.getFlowLines(t),this.lastXPos=i.lastXPadding,e=i.lines}return e}}!function(t){t[t.Text=0]="Text",t[t.TableCell=1]="TableCell",t[t.Drawing=2]="Drawing"}(p||(p={}));class Y{constructor(t,e){this._type=p.Text,this._runs=t,this._numberingRun=e}get style(){let t=0;for(;t<this._runs.length&&!(this._runs[t]instanceof U);)if(t++,t==this._runs.length)return new I;const e=this._runs[t];return void 0===e?new I:e.style.parStyle}get runs(){return this._runs}get numberingRun(){return this._numberingRun}get type(){return this._type}set type(t){this._type=t,this._runs.forEach(e=>{e instanceof U&&(e.paragraphType=t)})}getUsedWidth(t){let e=0;const i=this.runs;for(let s=0;s<i.length;s++){const r=i[s].getUsedWidth();if(r>=t){e=t;break}e+=r}return Math.min(e,t)}getHeight(){const t=this.style;let e=void 0!==t?t.spacingAfter+t.spacingBefore:0;return this.runs.forEach(t=>{e+=t.getHeight()}),e}performLayout(t){t.mentionParagraphPosition();const e=t.getY();let i=0;if(void 0!==this.style&&t.advancePosition(this.style.spacingBefore),void 0!==this.style.tabStops&&this.style.tabStops.forEach(e=>{e.performLayout(t),e.isClear?t.removeTabStop():t.addTabStop(e)}),void 0!==this._numberingRun){const e=t.clone();e.advancePosition(-X.getTopToBaseline(this._numberingRun.style)),this._numberingRun.performLayout(e),i=this._numberingRun.lastXPos}this.runs.forEach(e=>{e.previousXPos=i,e.performLayout(t),i=e.lastXPos,t.mentionCharacterPosition(e.lastXPos)}),void 0!==this.style&&t.advancePosition(this.style.spacingAfter);const s=this._getLineSpacing();t.getY()-e<s&&t.advancePosition(s)}_getLineSpacing(){return this.runs[0]instanceof U?this.runs[0].style.lineSpacing:10}}!function(t){t[t.Solid=0]="Solid",t[t.Dashed=1]="Dashed",t[t.Dotted=2]="Dotted",t[t.DashedSmallGap=3]="DashedSmallGap",t[t.DotDash=4]="DotDash",t[t.DotDotDash=5]="DotDotDash",t[t.LongDash=6]="LongDash"}(m||(m={}));class q{constructor(t){const e=document.createElementNS(q.svgNS,"svg"),i=t.clientWidth.toString();e.setAttribute("id","svg"),e.setAttribute("width",i),e.setAttribute("height","500"),e.setAttribute("style","white-space:pre"),t.appendChild(e),this._svg=e,this._root=e}get svg(){return this._svg}paintText(t,e,i,s,r,a,n,o,h,d,c){const l=document.createElementNS(q.svgNS,"text");this._setFont(l,o,h,d,c),this._setColor(l,a),this._setHorizontalAlignment(l,t,i,n,s),this._setVerticalAlignment(l,e,h);const u=document.createTextNode(r);l.appendChild(u),this._svg.appendChild(l),this._lastText=l}measureLastText(){let t;if(void 0!==this._lastText){const e=this._lastText.getBBox();t={x:e.x,y:e.y,width:e.width,height:e.height}}else t={x:0,y:0,width:0,height:0};return t}paintLine(t,e,i,s,r,a,n){const o=document.createElementNS(q.svgNS,"line");o.setAttribute("x1",t.toString()),o.setAttribute("y1",e.toString()),o.setAttribute("x2",i.toString()),o.setAttribute("y2",s.toString()),o.setAttribute("stroke","#"+r),o.setAttribute("stroke-width",a.toString()),this._setDashing(o,n),this._svg.appendChild(o)}paintPolygon(t,e,i,s,r){const a=document.createElementNS(q.svgNS,"path");a.setAttribute("d",t),void 0!==e&&a.setAttribute("fill","#"+e),void 0!==i&&a.setAttribute("stroke","#"+i),a.setAttribute("stroke-width",""+s),this._setDashing(a,r),this._svg.appendChild(a)}paintPicture(t,e,i,s,r){void 0!==r&&r.getImageUrl().then(r=>{if(r instanceof SVGElement){const a=document.createElementNS(q.svgNS,"g");r.setAttribute("x",""+t),r.setAttribute("y",""+e),r.setAttribute("width",""+i),r.setAttribute("height",""+s),this.svg.appendChild(a),a.appendChild(r)}else{const a=document.createElementNS(q.svgNS,"image");a.setAttribute("x",""+t),a.setAttribute("y",""+e),a.setAttribute("width",""+i),a.setAttribute("height",""+s),this.svg.appendChild(a),a.setAttribute("xlink:href",""+r),a.setAttribute("href",""+r)}}).catch(t=>{console.log("ERROR during rendering: "+t)})}clear(){for(;this.svg.lastChild;)this.svg.removeChild(this.svg.lastChild)}setWidth(t){if(void 0!==B.getAttribute(this.svg,"width")){this._svg.setAttribute("width",""+t);const e=this._svg.parentElement;null!==e&&e.setAttribute("width",""+t)}}ensureHeight(t){const e=B.getAttribute(this.svg,"height");if(void 0!==e){const i=parseFloat(e),s=Math.max(i,t);if(s>i){this._svg.setAttribute("height",""+s);const t=this._svg.parentElement;null!==t&&t.setAttribute("height",""+s)}}}startLink(t){const e=document.createElementNS(q.svgNS,"a");e.setAttribute("href",t),this._svg=e,this._root.appendChild(this._svg)}endLink(){this._svg!==this._root&&(this._svg=this._root)}_setFont(t,e,i,s,r){t.setAttribute("font-family",e),t.setAttribute("font-size",i.toString()),s&&t.setAttribute("font-weight","bold"),r&&t.setAttribute("font-style","italic")}_setColor(t,e){t.setAttribute("fill","#"+e)}_setDashing(t,e){switch(e){case m.Dashed:t.setAttribute("stroke-dasharray","5 3");break;case m.LongDash:t.setAttribute("stroke-dasharray","8 3");break;case m.Dotted:t.setAttribute("stroke-dasharray","1");break;case m.DashedSmallGap:t.setAttribute("stroke-dasharray","5 2");break;case m.DotDash:t.setAttribute("stroke-dasharray","6 2 2 2");break;case m.DotDotDash:t.setAttribute("stroke-dasharray","6 2 2 2 2 2")}}_setHorizontalAlignment(t,e,i,s,r){switch(s){case c.both:t.setAttribute("x",e.toString()),r&&(t.setAttribute("textLength",i.toString()),t.setAttribute("lengthAdjust","spacing"));break;case c.right:const s=e+i;t.setAttribute("x",s.toString()),t.setAttribute("text-anchor","end");break;case c.center:const a=e+i/2;t.setAttribute("x",a.toString()),t.setAttribute("text-anchor","middle");break;case c.left:default:t.setAttribute("x",e.toString()),t.setAttribute("text-anchor","start")}}_setVerticalAlignment(t,e,i){t.setAttribute("y",e.toString())}}q.svgNS="http://www.w3.org/2000/svg",function(t){t[t.None=0]="None",t[t.Single=1]="Single",t[t.DashDotStroked=2]="DashDotStroked",t[t.Dashed=3]="Dashed",t[t.DashSmallGap=4]="DashSmallGap",t[t.DotDash=5]="DotDash",t[t.DotDotDash=6]="DotDotDash",t[t.Dotted=7]="Dotted",t[t.Double=8]="Double",t[t.DoubleWave=9]="DoubleWave",t[t.Inset=10]="Inset",t[t.Outset=11]="Outset",t[t.Thick=12]="Thick",t[t.ThickThinLargeGap=13]="ThickThinLargeGap",t[t.ThickThinMediumGap=14]="ThickThinMediumGap",t[t.ThickThinSmallGap=15]="ThickThinSmallGap",t[t.ThinThickLargeGap=16]="ThinThickLargeGap",t[t.ThinThickMediumGap=17]="ThinThickMediumGap",t[t.ThinThickSmallGap=18]="ThinThickSmallGap",t[t.ThinThickThinLargeGap=19]="ThinThickThinLargeGap",t[t.ThinThickThinMediumGap=20]="ThinThickThinMediumGap",t[t.ThinThickThinSmallGap=21]="ThinThickThinSmallGap",t[t.Emboss3D=22]="Emboss3D",t[t.Engrave3D=23]="Engrave3D",t[t.Triple=24]="Triple",t[t.Wave=25]="Wave"}(b||(b={}));class J{constructor(){this.type=b.None,this.size=1,this.spacing=0,this.color="000000"}}class Z{constructor(t,e){this._painter=t,this._parRenderer=e}renderTable(t){t.rows.forEach(e=>{e.cells.forEach(e=>{e.numRowsInSpan>0&&(this.renderCellShading(e),this.renderCellBorder(e,t.style),e.pars.forEach(t=>{this._parRenderer.renderParagraph(t)}))})})}renderCellShading(t){const e=t.bounds;if(""!==t.style.shading&&void 0!==e){const i=e.y+e.height/2;this._painter.paintLine(e.left,i,e.right,i,t.style.shading,e.height,m.Solid)}}renderCellBorder(t,e){let i=e.borders;const s=t.style.borders;0===e.cellSpacing&&t.style.hasBordersDefined&&(i=void 0);let r=t.bounds;void 0!==r&&(void 0!==i&&(void 0!==i.borderTop&&this._renderBorderPart(i.borderTop,{x1:r.left,y1:r.top,x2:r.right,y2:r.top,color:i.borderTop.color}),void 0!==i.borderBottom&&this._renderBorderPart(i.borderBottom,{x1:r.right,y1:r.bottom,x2:r.left,y2:r.bottom,color:i.borderBottom.color}),void 0!==i.borderStart&&this._renderBorderPart(i.borderStart,{x1:r.x,y1:r.bottom,x2:r.x,y2:r.top,color:i.borderStart.color}),void 0!==i.borderEnd&&this._renderBorderPart(i.borderEnd,{x1:r.right,y1:r.top,x2:r.right,y2:r.bottom,color:i.borderEnd.color})),void 0!==s&&(r.subtractSpacing(e.cellSpacing),void 0!==s.borderTop&&this._renderBorderPart(s.borderTop,{x1:r.left,y1:r.top,x2:r.right,y2:r.top,color:s.borderTop.color}),void 0!==s.borderBottom&&this._renderBorderPart(s.borderBottom,{x1:r.right,y1:r.bottom,x2:r.left,y2:r.bottom,color:s.borderBottom.color}),void 0!==s.borderStart&&this._renderBorderPart(s.borderStart,{x1:r.x,y1:r.bottom,x2:r.x,y2:r.top,color:s.borderStart.color}),void 0!==s.borderEnd&&this._renderBorderPart(s.borderEnd,{x1:r.right,y1:r.top,x2:r.right,y2:r.bottom,color:s.borderEnd.color})))}_renderBorderPart(t,e){let i=t.size;switch(t.type){case b.None:break;case b.Double:this._renderBorderSubLines(e,[{pos:0,width:2*t.size,dashing:m.Solid}]);break;case b.Triple:this._renderBorderSubLines(e,[{pos:0,width:3*t.size,dashing:m.Solid}]);break;case b.ThickThinLargeGap:i/=12,this._renderBorderSubLines(e,[{pos:2.5*i,width:5*i,dashing:m.Solid},{pos:10.5*i,width:i,dashing:m.Solid}]);break;case b.ThickThinMediumGap:i/=10,this._renderBorderSubLines(e,[{pos:2.5*i,width:5*i,dashing:m.Solid},{pos:8.5*i,width:i,dashing:m.Solid}]);break;case b.ThickThinSmallGap:i/=8,this._renderBorderSubLines(e,[{pos:2.5*i,width:5*i,dashing:m.Solid},{pos:6.5*i,width:i,dashing:m.Solid}]);break;case b.ThinThickLargeGap:i/=12,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Solid},{pos:8.5*i,width:5*i,dashing:m.Solid}]);break;case b.ThinThickMediumGap:i/=10,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Solid},{pos:6.5*i,width:5*i,dashing:m.Solid}]);break;case b.ThinThickSmallGap:i/=8,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Solid},{pos:4.5*i,width:5*i,dashing:m.Solid}]);break;case b.ThinThickThinLargeGap:i/=18,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Solid},{pos:8.5*i,width:5*i,dashing:m.Solid},{pos:16.5*i,width:i,dashing:m.Solid}]);break;case b.ThinThickThinMediumGap:i/=14,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Solid},{pos:2.5*i,width:5*i,dashing:m.Solid},{pos:12.5*i,width:i,dashing:m.Solid}]);break;case b.ThinThickThinSmallGap:i/=10,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Solid},{pos:4.5*i,width:5*i,dashing:m.Solid},{pos:8.5*i,width:i,dashing:m.Solid}]);break;case b.DashDotStroked:i/=3,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Dashed},{pos:2.5*i,width:i,dashing:m.Dotted}]);break;case b.Dashed:this._renderBorderSubLines(e,[{pos:0,width:t.size,dashing:m.Dashed}]);break;case b.DashSmallGap:this._renderBorderSubLines(e,[{pos:0,width:t.size,dashing:m.DashedSmallGap}]);break;case b.DotDash:i/=3,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Dotted},{pos:2.5*i,width:i,dashing:m.Dashed}]);break;case b.DotDotDash:i/=5,this._renderBorderSubLines(e,[{pos:.5*i,width:i,dashing:m.Dotted},{pos:2.5*i,width:i,dashing:m.Dotted},{pos:4.5*i,width:i,dashing:m.Dashed}]);break;case b.Dotted:this._renderBorderSubLines(e,[{pos:0,width:t.size,dashing:m.Dotted}]);break;case b.Single:default:this._renderBorderSubLines(e,[{pos:0,width:t.size,dashing:m.Solid}])}}_renderBorderSubLines(t,e){const i=t.x1===t.x2?t.y1<t.y2?-1:1:0,s=t.y1===t.y2?t.x1>t.x2?-1:1:0;e.forEach(e=>{this._painter.paintLine(t.x1+i*e.pos,t.y1+s*e.pos,t.x2+i*e.pos,t.y2+s*e.pos,t.color,e.width,e.dashing)})}}class Q{constructor(t){this._painter=t}renderTextRun(t){const e=t.linkTarget;void 0!==e&&this._painter.startLink(e),t.getLines().forEach(e=>{this._renderText(e,t.style)}),void 0!==e&&this._painter.endLink()}_renderText(t,e){const i=this._getX(t);if("000000"!==e.shadingColor){const s=e.lineSpacing,r=t.y-X.getTopToBaseline(e)+s/2;this._painter.paintLine(i,r,i+t.width,r,e.shadingColor,s,m.Solid)}const s=void 0!==t.justification?t.justification:e.justification,r=Boolean(t.emphasis&u.Bold),a=Boolean(t.emphasis&u.Italic);this._painter.paintText(i,t.y,t.width,t.stretched,t.text,t.color,s,t.fontFamily,t.fontSize,r,a),(e.underlineMode!==d.None||e.strike||e.doubleStrike)&&this._renderUnderline(e)}_renderUnderline(t){const e=this._painter.measureLastText(),i=t.fontSize,s=e.y+i,r="auto"===t.color?"000000":t.color,a=i/24,n=2*a;switch(t.underlineMode){case d.Double:this._painter.paintLine(e.x,s,e.x+e.width,s,r,a,m.Solid),this._painter.paintLine(e.x,s+3*a,e.x+e.width,s+3*a,r,a,m.Solid);break;case d.Thick:this._painter.paintLine(e.x,s+a,e.x+e.width,s+a,r,n,m.Solid);break;case d.Dotted:this._painter.paintLine(e.x,s,e.x+e.width,s,r,a,m.Dotted);break;case d.DottedHeavy:this._painter.paintLine(e.x,s+a,e.x+e.width,s+a,r,n,m.Dotted);break;case d.Dash:this._painter.paintLine(e.x,s,e.x+e.width,s,r,a,m.Dashed);break;case d.DashedHeavy:this._painter.paintLine(e.x,s+a,e.x+e.width,s+a,r,n,m.Dashed);break;case d.DotDash:this._painter.paintLine(e.x,s,e.x+e.width,s,r,a,m.DotDash);break;case d.DashDotHeavy:this._painter.paintLine(e.x,s+a,e.x+e.width,s+a,r,n,m.DotDash);break;case d.DotDotDash:this._painter.paintLine(e.x,s,e.x+e.width,s,r,a,m.DotDotDash);break;case d.DashDotDotHeavy:this._painter.paintLine(e.x,s+a,e.x+e.width,s+a,r,n,m.DotDotDash);break;case d.DashLong:this._painter.paintLine(e.x,s,e.x+e.width,s,r,a,m.LongDash);break;case d.DashLongHeavy:this._painter.paintLine(e.x,s+a,e.x+e.width,s+a,r,n,m.LongDash);break;case d.None:break;default:case d.Single:this._painter.paintLine(e.x,s,e.x+e.width,s,r,a,m.Solid)}t.strike&&this._painter.paintLine(e.x,s-i/2,e.x+e.width,s-i/2,r,1,m.Solid),t.doubleStrike&&(this._painter.paintLine(e.x,s,e.x+e.width,s-i/2-1,r,1,m.Solid),this._painter.paintLine(e.x,s,e.x+e.width,s-i/2+2,r,1,m.Solid))}_getX(t){let e=t.x;if(t.following){const t=this._painter.measureLastText();e=Math.max(e,t.x+t.width)}return e}}class K{constructor(){this.fillColor=void 0,this.lineColor=void 0,this.lineThickness=1}}class tt{constructor(t){this.style=new K,this.bounds=new L(0,0,0,0),this.space=t}determineRange(){if(void 0!==this.valueAxis&&this.space.chart.series[0].hasNumericValues){const t=this.space.chart.getValueRange();t.max=Math.ceil(1.2*t.max),this.space.chart.setValueRange(t.min,t.max)}}}!function(t){t[t.Top=0]="Top",t[t.Bottom=1]="Bottom",t[t.Left=2]="Left",t[t.Right=3]="Right"}(_||(_={})),function(t){t[t.None=0]="None",t[t.Outwards=1]="Outwards"}(f||(f={})),function(t){t[t.Center=0]="Center"}(w||(w={})),function(t){t[t.AutoZero=0]="AutoZero"}(v||(v={}));class et{constructor(t,e,i,s,r,a,n){this.labelAlignment=w.Center,this.crossMode=v.AutoZero,this.positionedTexts=void 0,this.positionedLines=void 0,this._space=t,this.style=e,this.position=i,this.majorTickMode=s,this.minorTickMode=r,this.labelOffset=a,this.majorGridStyle=new K,this.minorGridStyle=new K,this._isValueAxis=n}get isValueAxis(){return this._isValueAxis}get isCategoryAxis(){return!this._isValueAxis}getMaxDistanceFromPlot(){let t;if(this.position===_.Bottom||this.position===_.Top)t=et._labelSpacing+this._space.textStyle.lineSpacing;else{let e=0;this._getTexts().forEach(t=>{e=Math.max(e,t.length)}),t=e*X.averageCharWidth(this._space.textStyle),t+=et._labelSpacing}return this.majorTickMode===f.Outwards?t+=et._majorOutwardLength:this.minorTickMode===f.Outwards&&(t+=et._minorOutwardLength),t}performLayout(){this.positionedTexts=[],this.positionedLines=[];const t=this.positionedTexts,e=this.positionedLines,i=this._space.plotArea.bounds,s=this._hasNumericValues();switch(this.position){case _.Left:if(s){const{min:s,max:r}=this._space.chart.getValueRange(),a=this._getMajorValues(s,r).reverse(),n=this._space.textStyle.fontSize/2,o=i.height/(a.length-1);let h=i.top,d=i.left-et._labelSpacing,l=i.left,u=i.left;this.majorTickMode===f.Outwards?(d-=et._majorOutwardLength,u-=et._majorOutwardLength):this.minorTickMode===f.Outwards&&(d-=et._minorOutwardLength,u-=et._minorOutwardLength),void 0!==this.majorGridStyle.lineColor&&(l=i.right),a.forEach(i=>{t.push(this._createPositionedText(d,h+n,i,c.right)),e.push({x1:l,x2:u,y1:h,y2:h}),h+=o})}break;case _.Right:case _.Top:break;case _.Bottom:if(!s){const s=this._getTexts();let r=s.length,a=1;this._space.chartType!==S.Bar&&(r--,a=0);const n=i.width/r/2;let o=i.x,h=i.bottom+et._labelSpacing+X.getTopToBaseline(this._space.textStyle),d=i.bottom,l=i.bottom;this.majorTickMode===f.Outwards?(h+=et._majorOutwardLength,l+=et._majorOutwardLength):this.minorTickMode===f.Outwards&&(h+=et._minorOutwardLength,l+=et._minorOutwardLength),void 0!==this.majorGridStyle.lineColor&&(d=i.top),s.forEach(i=>{t.push(this._createPositionedText(o+a*n,h,i,c.center)),e.push({x1:o,x2:o,y1:d,y2:l}),o+=2*n}),e.push({x1:o,x2:o,y1:d,y2:l})}}}_hasNumericValues(){const t=this._space.chart;return this.isValueAxis?t.series[0].hasNumericValues:t.series[0].hasNumericCategories}_getTexts(){const{min:t,max:e}=this._space.chart.getValueRange();return this.isValueAxis?this._getMajorValues(t,e):this._getCategoryNames()}_getCategoryNames(){return this._space.chart.series[0].categories.map(t=>t.toString())}_getMajorValues(t,e){const i=[],s=(e-t)/et._numMajorTicks;for(let r=t;r<=e;r+=s)i.push(r.toString());return i}_createPositionedText(t,e,i,s){const r=this._space.textStyle;return{text:i,x:t,y:e,width:0,stretched:!1,following:!1,justification:s,color:r.color,fontFamily:r.fontFamily,fontSize:r.fontSize,emphasis:r.emphasis}}}et._labelSpacing=5,et._majorOutwardLength=5,et._minorOutwardLength=5,et._numMajorTicks=6;class it{constructor(t){this.style=new K,this.position=_.Right,this.overlayOnPlot=!1,this.onlySeries=void 0,this.bounds=new L(0,0,0,0),this.space=t}get widgetSize(){return it._widgetSize}get widgetSpacing(){return it._widgetSpacing}getLines(){const t=[],e=this.space.textStyle,i=this.bounds.x+it._widgetSize+it._widgetSpacing;let s=this.bounds.y+X.getTopToBaseline(e);return this._getNames().forEach(r=>{t.push({text:r,x:i,y:s,width:this.bounds.width,stretched:!1,following:!1,color:e.color,fontFamily:e.fontFamily,fontSize:e.fontSize,emphasis:e.emphasis}),s+=e.lineSpacing}),t}performLayout(){const t=this._getSize(),e=this.space.bounds;let i=s.Last,r=s.Middle;switch(this.position){case _.Left:i=s.First,r=s.Middle;break;case _.Right:i=s.Last,r=s.Middle;break;case _.Top:i=s.Middle,r=s.First;break;case _.Right:i=s.Middle,r=s.Last}this.bounds=e.subtractSpacing(it.spacing).placeInRectangle(t.width,t.height,i,r)}getColors(){let t;return t=void 0===this.onlySeries?this.space.chart.series.map(t=>t.style.lineColor||t.style.fillColor||"000000"):this.space.chart.series[this.onlySeries].categories.map(t=>{let e="000000";return void 0!==t.style&&(e=t.style.lineColor||t.style.fillColor||"000000"),e}),t}_getNames(){let t;return t=void 0===this.onlySeries?this.space.chart.series.map(t=>t.name):this.space.chart.series[this.onlySeries].categories.map(t=>t.text||""),t}_getSize(){const t=X.averageCharWidth(this.space.textStyle);let e=0;const i=this._getNames();i.forEach(t=>{e=Math.max(e,t.length)});const s=this.space.textStyle.lineSpacing,r=i.length*s;return{width:(e+1)*t+(it._widgetSize+it._widgetSpacing),height:r}}}it._widgetSize=10,it._widgetSpacing=5,it.spacing=5,function(t){t[t.Bar=0]="Bar",t[t.Line=1]="Line",t[t.Area=2]="Area",t[t.Pie=3]="Pie"}(S||(S={}));class st{constructor(){this._promise=void 0,this._chart=void 0,this._type=S.Bar,this.style=new K,this.textStyle=new $,this.legend=void 0,this.bounds=new L(0,0,0,0),this.textStyle.runStyle.updateFont("Arial",!1,11),this.textStyle.parStyle.setLineSpacing(240),this.plotArea=new tt(this)}async ensureLoaded(){void 0!==this._promise&&(await this._promise,this._promise=void 0)}get chartType(){return this._type}get chart(){return this._chart}setAreaChart(t){this._chart=t,this._type=S.Area}setLineChart(t){this._chart=t,this._type=S.Line}setBarChart(t){this._chart=t,this._type=S.Bar}setPieChart(t){this._chart=t,this._type=S.Pie}setPromise(t){this.ensureLoaded(),this._promise=t}performLayout(t){const e=new Promise(async(t,e)=>{await this._promise,this._performLayout(),t()});this.setPromise(e)}_performLayout(){this.plotArea.determineRange();let t=this.bounds.subtractSpacing(10);void 0!==this.legend&&(t=this._layoutLegend(t,this.legend)),void 0!==this.plotArea.valueAxis&&(t=this._subtractAxis(t,this.plotArea.valueAxis)),void 0!==this.plotArea.categoryAxis&&(t=this._subtractAxis(t,this.plotArea.categoryAxis)),this.plotArea.bounds=t,void 0!==this.plotArea.valueAxis&&this.plotArea.valueAxis.performLayout(),void 0!==this.plotArea.categoryAxis&&this.plotArea.categoryAxis.performLayout()}_layoutLegend(t,e){if(e.performLayout(),!e.overlayOnPlot){let i=0,s=0,r=0,a=0;switch(e.position){case _.Left:i+=e.bounds.width+it.spacing;break;case _.Right:s+=e.bounds.width+it.spacing;break;case _.Top:r+=e.bounds.height+it.spacing;break;case _.Bottom:a+=e.bounds.height+it.spacing}return t.subtractBorder(i,r,s,a)}return t}_subtractAxis(t,e){const i=e.getMaxDistanceFromPlot();let s=0,r=0,a=0,n=0;switch(e.position){case _.Left:s+=i;break;case _.Right:r+=i;break;case _.Top:a+=i;break;case _.Bottom:n+=i}return t.subtractBorder(s,a,r,n)}}class rt{constructor(t){this._degrees=0,this._degrees=t}static fromRotation(t){return new rt(t/6e4)}static fromDegrees(t){return new rt(t)}static fromRadians(t){return new rt(180*t/Math.PI)}static fromNormalized(t){return new rt(360*t)}add(t){return new rt(this._degrees+t._degrees)}subtract(t){return new rt(this._degrees-t._degrees)}round(t){t&&360===this._degrees||(this._degrees=(this._degrees+360)%360)}toDegrees(){return this._degrees}toNormalized(){return this._degrees/360}toRadians(){return this._degrees*Math.PI/180}toRotation(){return 6e4*this._degrees}toString(){return this._degrees+"°"}}class at{constructor(t,e,i,s){this.name=t,this.x=e,this.y=i,this.z=s}evaluate(t){return t.getValue(this.x)*t.getValue(this.y)/t.getValue(this.z)}toString(){return`${this.name}: */ ${this.x} ${this.y} ${this.z}`}}class nt{constructor(t,e,i,s){this.name=t,this.x=e,this.y=i,this.z=s}evaluate(t){return t.getValue(this.x)+t.getValue(this.y)-t.getValue(this.z)}toString(){return`${this.name}: +- ${this.x} ${this.y} ${this.z}`}}class ot{constructor(t,e,i,s){this.name=t,this.x=e,this.y=i,this.z=s}evaluate(t){return(t.getValue(this.x)+t.getValue(this.y))/t.getValue(this.z)}toString(){return`${this.name}: +* ${this.x} ${this.y} ${this.z}`}}class ht{constructor(t,e,i,s){this.name=t,this.x=e,this.y=i,this.z=s}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y),s=t.getValue(this.z);return e>0?i:s}toString(){return`${this.name}: ?: ${this.x} ${this.y} ${this.z}`}}class dt{constructor(t,e){this.name=t,this.x=e}evaluate(t){const e=t.getValue(this.x);return Math.abs(e)}toString(){return`${this.name}: abs ${this.x}`}}class ct{constructor(t,e,i){this.name=t,this.x=e,this.y=i}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y);return Math.atan2(i,e)}toString(){return`${this.name}: at2 ${this.x} ${this.y}`}}class lt{constructor(t,e,i,s){this.name=t,this.x=e,this.y=i,this.z=s}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y),s=t.getValue(this.z);return e*Math.cos(Math.atan2(s,i))}toString(){return`${this.name}: cat2 ${this.x} ${this.y} ${this.z}`}}class ut{constructor(t,e,i){this.name=t,this.x=e,this.y=i}evaluate(t){const e=t.getValue(this.x),i=t.getAngleValue(this.y);return e*Math.cos(i.toRadians())}toString(){return`${this.name}: cos ${this.x} ${this.y}`}}class gt{constructor(t,e,i){this.name=t,this.x=e,this.y=i}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y);return Math.max(e,i)}toString(){return`${this.name}: max ${this.x} ${this.y}`}}class pt{constructor(t,e,i){this.name=t,this.x=e,this.y=i}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y);return Math.min(e,i)}toString(){return`${this.name}: min ${this.x} ${this.y}`}}class mt{constructor(t,e,i,s){this.name=t,this.x=e,this.y=i,this.z=s}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y),s=t.getValue(this.z);return Math.sqrt(e*e+i*i+s*s)}toString(){return`${this.name}: mod ${this.x} ${this.y} ${this.z}`}}class bt{constructor(t,e,i,s){this.name=t,this.x=e,this.y=i,this.z=s}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y),s=t.getValue(this.z);return i<e?e:i>s?s:i}toString(){return`${this.name}: pin ${this.x} ${this.y} ${this.z}`}}class _t{constructor(t,e,i,s){this.name=t,this.x=e,this.y=i,this.z=s}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y),s=t.getValue(this.z);return e*Math.sin(Math.atan2(s,i))}toString(){return`${this.name}: sat2 ${this.x} ${this.y} ${this.z}`}}class ft{constructor(t,e,i){this.name=t,this.x=e,this.y=i}evaluate(t){const e=t.getValue(this.x),i=t.getAngleValue(this.y);return e*Math.sin(i.toRadians())}toString(){return`${this.name}: sin ${this.x} ${this.y}`}}class wt{constructor(t,e){this.name=t,this.x=e}evaluate(t){const e=t.getValue(this.x);return Math.sqrt(e)}toString(){return`${this.name}: sqrt ${this.x}`}}class vt{constructor(t,e,i){this.name=t,this.x=e,this.y=i}evaluate(t){const e=t.getValue(this.x),i=t.getValue(this.y);return e*Math.tan(i)}toString(){return`${this.name}: tan ${this.x} ${this.y}`}}class St{constructor(t,e){this.name=t,this.x=e}evaluate(t){return t.getValue(this.x)}toString(){return`${this.name}: val ${this.x}`}}class yt{constructor(t,e){this.name=t,this.func=e}evaluate(t){return this.func(t.shape)}toString(){return this.name+": function"}}class kt{constructor(t){this._formulas=[],this._variables=[],this.shape=t}addFormula(t,e){const i=t.split(" ");if(i.length<2)return void console.log("Invalid formula for shape guide: "+t);let s=void 0;switch(i[0]){case"*/":s=new at(e,i[1],i[2],i[3]);break;case"+-":s=new nt(e,i[1],i[2],i[3]);break;case"+/":s=new ot(e,i[1],i[2],i[3]);break;case"?:":s=new ht(e,i[1],i[2],i[3]);break;case"abs":s=new dt(e,i[1]);break;case"at2":s=new ct(e,i[1],i[2]);break;case"cat2":s=new lt(e,i[1],i[2],i[3]);break;case"cos":s=new ut(e,i[1],i[2]);break;case"max":s=new gt(e,i[1],i[2]);break;case"min":s=new pt(e,i[1],i[2]);break;case"mod":s=new mt(e,i[1],i[2],i[3]);break;case"pin":s=new bt(e,i[1],i[2],i[3]);break;case"sat2":s=new _t(e,i[1],i[2],i[3]);break;case"sin":s=new ft(e,i[1],i[2]);break;case"sqrt":s=new wt(e,i[1]);break;case"tan":s=new vt(e,i[1],i[2]);break;case"val":s=new St(e,i[1]);break;default:console.log("Don't know how to interpret formula: "+i[0])}void 0!==s&&this._formulas.push(s)}getValue(t){let e;return e=/^(\d|-)/.test(t)&&-1===t.indexOf("cd")?parseFloat(t):this._getVariableValue(t),e}getAngleValue(t){const e=this.getValue(t);return rt.fromRotation(e)}evaluate(){this._formulas.forEach(t=>{this._evaluateVariable(t)})}getVariableValueSummary(){return this._variables.map(t=>`${t.name}:${t.val}`).join(";")}_getVariableValue(t){let e=this._variables.find(e=>e.name===t);if(void 0===e)switch(t){case"h":e=this._createNamedVariable(new yt("h",t=>t.height));break;case"hd2":e=this._createNamedVariable(new yt("hd2",t=>t.height/2));break;case"hd3":e=this._createNamedVariable(new yt("hd3",t=>t.height/3));break;case"hd4":e=this._createNamedVariable(new yt("hd4",t=>t.height/4));break;case"hd5":e=this._createNamedVariable(new yt("hd5",t=>t.height/5));break;case"hd6":e=this._createNamedVariable(new yt("hd6",t=>t.height/6));break;case"hd8":e=this._createNamedVariable(new yt("hd8",t=>t.height/8));break;case"w":e=this._createNamedVariable(new yt("w",t=>t.width));break;case"wd2":e=this._createNamedVariable(new yt("wd2",t=>t.width/2));break;case"wd3":e=this._createNamedVariable(new yt("wd3",t=>t.width/3));break;case"wd4":e=this._createNamedVariable(new yt("wd4",t=>t.width/4));break;case"wd5":e=this._createNamedVariable(new yt("wd5",t=>t.width/5));break;case"wd6":e=this._createNamedVariable(new yt("wd6",t=>t.width/6));break;case"wd8":e=this._createNamedVariable(new yt("wd8",t=>t.width/8));break;case"wd10":e=this._createNamedVariable(new yt("wd10",t=>t.width/10));break;case"cd2":e=this._createNamedVariable(new yt("cd2",t=>rt.fromNormalized(.5).toRotation()));break;case"cd4":e=this._createNamedVariable(new yt("cd4",t=>rt.fromNormalized(1/4).toRotation()));break;case"cd8":e=this._createNamedVariable(new yt("cd8",t=>rt.fromNormalized(1/8).toRotation()));break;case"3cd4":e=this._createNamedVariable(new yt("3cd4",t=>rt.fromNormalized(3/4).toRotation()));break;case"3cd8":e=this._createNamedVariable(new yt("3cd8",t=>rt.fromNormalized(3/8).toRotation()));break;case"5cd8":e=this._createNamedVariable(new yt("5cd8",t=>rt.fromNormalized(5/8).toRotation()));break;case"7cd8":e=this._createNamedVariable(new yt("7cd8",t=>rt.fromNormalized(7/8).toRotation()));break;case"hc":e=this._createNamedVariable(new yt("hc",t=>t.width/2));break;case"vc":e=this._createNamedVariable(new yt("vc",t=>t.height/2));break;case"t":e=this._createNamedVariable(new yt("t",t=>0));break;case"b":e=this._createNamedVariable(new yt("b",t=>t.height));break;case"r":e=this._createNamedVariable(new yt("r",t=>t.width));break;case"l":e=this._createNamedVariable(new yt("l",t=>0));break;case"ss":e=this._createNamedVariable(new yt("ss",t=>Math.min(t.width,t.height)));break;case"ssd2":e=this._createNamedVariable(new yt("ssd2",t=>Math.min(t.width,t.height)/2));break;case"ssd3":e=this._createNamedVariable(new yt("ssd3",t=>Math.min(t.width,t.height)/3));break;case"ssd4":e=this._createNamedVariable(new yt("ssd4",t=>Math.min(t.width,t.height)/4));break;case"ssd6":e=this._createNamedVariable(new yt("ssd6",t=>Math.min(t.width,t.height)/6));break;case"ssd8":e=this._createNamedVariable(new yt("ssd8",t=>Math.min(t.width,t.height)/8));break;case"ssd16":e=this._createNamedVariable(new yt("ssd16",t=>Math.min(t.width,t.height)/16));break;case"ssd32":e=this._createNamedVariable(new yt("ssd32",t=>Math.min(t.width,t.height)/32));break;case"ls":e=this._createNamedVariable(new yt("ls",t=>Math.max(t.width,t.height)));break;default:const i=this._formulas.map(t=>t.name).join(",");console.log(`Unable to find variable ${t} in Shape Guide which defines variables: ${i}.`)}return void 0!==e?e.val:Number.NaN}_evaluateVariable(t){this._variables.push(this._createNamedVariable(t))}_createNamedVariable(t){return{name:t.name,val:t.evaluate(this)}}}class xt{constructor(t,e,i){this.center=t,this.radiusX=e,this.radiusY=i}static fromSinglePoint(t,e,i,s){const r=e.toRadians(),a=xt._localRadius(r,i,s),n=t.x-a*Math.cos(r),o=t.y-a*Math.sin(r),h=new D(n,o);return new xt(h,i,s)}pointAtAngle(t){const e=t.toRadians(),i=this.localRadius(t),s=this.center.x+i*Math.cos(e),r=this.center.y+i*Math.sin(e);return new D(s,r)}localRadius(t){const e=t.toRadians();return xt._localRadius(e,this.radiusX,this.radiusY)}clone(){return new xt(this.center.clone(),this.radiusX,this.radiusY)}static _localRadius(t,e,i){const s=e*Math.sin(t),r=i*Math.cos(t);return e*i/Math.sqrt(r*r+s*s)}}class Nt{constructor(){this._offset=new D(0,0),this._scaling=new D(1,1)}translate(t){this._offset=t}scale(t){this._scaling=t}convertPoint(t,e){return t.convertToPoint(e).scale(this._scaling).translate(this._offset)}}class Tt extends Nt{getEndPoint(t,e){return new D(0,0)}buildPath(t,e){return" Z"}clone(){return new Tt}}class Ct extends Nt{constructor(t){super(),this.point=t}getEndPoint(t,e){return this.convertPoint(this.point,t)}buildPath(t,e){const i=this.convertPoint(this.point,t);return` M ${i.x} ${i.y}`}clone(){return new Ct(this.point)}}class Pt extends Ct{getEndPoint(t,e){return this.convertPoint(this.point,t)}buildPath(t,e){const i=this.convertPoint(this.point,t);return` L ${i.x} ${i.y}`}clone(){return new Pt(this.point)}}class At extends Nt{constructor(t,e,i,s){super(),this.sweepAngle=t,this.startAngle=e,this.radiusX=i,this.radiusY=s}getEndPoint(t,e,i){const s=this._getAngleValue(t,this.startAngle,!1);let r=i||this._getAngleValue(t,this.sweepAngle,!0);const a=t.getValue(this.radiusX)*this._scaling.x,n=t.getValue(this.radiusY)*this._scaling.y;return xt.fromSinglePoint(e,s,a,n).pointAtAngle(s.add(r))}buildPath(t,e){let i=this._getAngleValue(t,this.sweepAngle,!0);const s=this._clockwise(t),r=t.getValue(this.radiusX)*this._scaling.x,a=t.getValue(this.radiusY)*this._scaling.y,n=this.getEndPoint(t,e);if(this._fullRotation(t)){const i=this.getEndPoint(t,e,rt.fromNormalized(.5));return`${this._buildInternalPath(i,Math.PI,r,a,!0)}${this._buildInternalPath(n,Math.PI,r,a,!0)}`}return this._buildInternalPath(n,i.toRadians(),r,a,s)}clone(){return new At(this.sweepAngle,this.startAngle,this.radiusX,this.radiusY)}_buildInternalPath(t,e,i,s,r){return` A ${i} ${s} 0 ${e>Math.PI?"1":"0"} ${r?"1":"0"} ${t.x} ${t.y}`}_getAngleValue(t,e,i){const s=t.getValue(e),r=rt.fromRotation(s);return r.round(i),r}_clockwise(t){return t.getValue(this.sweepAngle)>0}_fullRotation(t){const e=t.getValue(this.sweepAngle);return 1===rt.fromRotation(e).toNormalized()}}class Dt extends Nt{constructor(t,e,i){super(),this.endPoint=t,this.control1=e,this.control2=i}getEndPoint(t,e){return this.convertPoint(this.endPoint,t)}buildPath(t,e){const i=this.convertPoint(this.endPoint,t),s=this.convertPoint(this.control1,t),r=this.convertPoint(this.control2,t);return` C ${s.x} ${s.y}, ${r.x} ${r.y}, ${i.x} ${i.y}`}clone(){return new Dt(this.endPoint,this.control1,this.control2)}}class Lt extends Nt{constructor(t,e){super(),this.endPoint=t,this.control=e}getEndPoint(t,e){return this.convertPoint(this.endPoint,t)}buildPath(t,e){const i=this.convertPoint(this.endPoint,t),s=this.convertPoint(this.control,t),r=e.translate(D.difference(s,e).scale(2/3)),a=i.translate(D.difference(s,i).scale(2/3));return` C ${r.x} ${r.y}, ${a.x} ${a.y}, ${i.x} ${i.y}`}clone(){return new Lt(this.endPoint,this.control)}}class Mt{constructor(t,e=!0,i=!0){this.segments=[],this._path=void 0,this._guide=t,this.filledIn=e,this.stroked=i}translate(t){this.segments.forEach(e=>{e.translate(t)})}scale(t){this.segments.forEach(e=>{e.scale(t)})}moveTo(t){this.segments.push(new Ct(t))}lineTo(t){this.segments.push(new Pt(t))}arcTo(t,e,i,s){this.segments.push(new At(t,e,i,s))}quadBezierTo(t,e){this.segments.push(new Lt(t,e))}cubicBezierTo(t,e,i){this.segments.push(new Dt(t,e,i))}close(){this.segments.push(new Tt)}buildPath(){if(void 0===this._path){this._path="",this._guide.evaluate();let t=new D(0,0);this.segments.forEach(e=>{this._path+=e.buildPath(this._guide,t),t=e.getEndPoint(this._guide,t)}),this._path=this._path.substr(1)}return this._path}clone(){const t=new Mt(this._guide);return t.segments=this.segments.map(t=>t.clone()),t}}class Ft{constructor(){this.width=1,this.height=1,this.fillColor=void 0,this.lineColor=void 0,this.guide=new kt(this),this.paths=[],this.paths.push(new Mt(this.guide))}translate(t){this.paths.forEach(e=>{e.translate(t)})}scale(t){this.paths.forEach(e=>{e.scale(t)})}addSegmentMove(t){this.paths[this.paths.length-1].moveTo(t)}addSegmentLine(t){this.paths[this.paths.length-1].lineTo(t)}addSegmentArc(t,e,i,s){this.paths[this.paths.length-1].arcTo(t,e,i,s)}addSegmentQuadBezier(t,e){this.paths[this.paths.length-1].quadBezierTo(t,e)}addSegmentCubicBezier(t,e,i){this.paths[this.paths.length-1].cubicBezierTo(t,e,i)}addSegmentClose(){this.paths[this.paths.length-1].close()}addPath(t,e){this.paths.push(new Mt(this.guide,t,e))}performLayout(t){const e=t.width/this.width,i=t.height/this.height;this.scale(new D(e,i)),this.translate(t.topLeft)}clone(){const t=new Ft;return t.width=this.width,t.height=this.height,t.guide=this.guide,t.lineColor=this.lineColor,t.fillColor=this.fillColor,t.paths=this.paths.map(t=>t.clone()),t}}class Et{constructor(t,e){this.x=t,this.y=e}static fromPoint(t){return new Et(t.x.toString(),t.y.toString())}convertToPoint(t){const e=t.getValue(this.x),i=t.getValue(this.y);return new D(e,i)}}class Vt{constructor(t){this._painter=t}renderChartSpace(t){const e=t.bounds;if(void 0!==e){this._renderBorderAndShading(t.style,e);const i=this._renderBorderAndShading(t.plotArea.style,t.plotArea.bounds);switch(void 0!==t.legend&&this._renderLegend(t.legend),void 0!==t.plotArea.categoryAxis&&this._renderAxis(t.plotArea.categoryAxis),void 0!==t.plotArea.valueAxis&&this._renderAxis(t.plotArea.valueAxis),t.chartType){case S.Bar:this._renderBarChart(t.chart,i);break;case S.Line:this._renderLineChart(t.chart,i);break;case S.Area:this._renderAreaChart(t.chart,i);break;case S.Pie:this._renderPieChart(t.chart,i)}}}_renderBorderAndShading(t,e){let i=0;const s=e.left,r=e.top,a=e.right,n=e.bottom,o=t.lineColor;if(void 0!==o){const e=t.lineThickness;this._painter.paintLine(s,r,a,r,o,e,m.Solid),this._painter.paintLine(a,r,a,n,o,e,m.Solid),this._painter.paintLine(s,n,a,n,o,e,m.Solid),this._painter.paintLine(s,r,s,n,o,e,m.Solid),i=e}const h=t.fillColor;if(void 0!==h){const t=r+e.height/2;this._painter.paintLine(s,t,a,t,h,e.height,m.Solid)}return e.subtractSpacing(i)}_renderLegend(t){this._renderBorderAndShading(t.style,t.bounds);const e=t.getColors(),i=t.widgetSize;t.getLines().forEach((s,r)=>{const a=s.x-i-t.widgetSpacing,n=s.y-3;this._painter.paintLine(a,n,a+i,n,e[r],i,m.Solid),this._painter.paintText(s.x,s.y,s.width,s.stretched,s.text,s.color,s.justification,s.fontFamily,s.fontSize,!1,!1)})}_renderAxis(t){if(void 0!==t.positionedTexts&&t.positionedTexts.forEach(t=>{this._painter.paintText(t.x,t.y,t.width,t.stretched,t.text,t.color,t.justification,t.fontFamily,t.fontSize,!1,!1)}),void 0!==t.positionedLines&&void 0!==t.style.lineColor){const e=t.style.lineColor,i=t.style.lineThickness;t.positionedLines.forEach(t=>{this._painter.paintLine(t.x1,t.y1,t.x2,t.y2,e,i,m.Solid)})}}_renderAreaChart(t,e){const i=t.getCounts(),s=e.width/i.numSeries,r=e.x,a=e.y,n=a+e.height,o=t.getValueRange();for(let h=i.numSeries-1;h>=0;h--){const d=new Ft;d.addSegmentMove(Et.fromPoint(e.bottomLeft));const c=t.series[h].style;for(let e=0;e<i.numCats&&(void 0!==c.fillColor&&"ffffff"!==c.fillColor);e++){const i=r+e*s,c=n-(n-a)*this._normalizeValue(t.getValue(e,h),o);d.addSegmentLine(new Et(i.toString(),c.toString()))}d.addSegmentLine(Et.fromPoint(e.bottomRight)),d.addSegmentLine(Et.fromPoint(e.bottomLeft));const l=d.paths[0].buildPath();this._painter.paintPolygon(l,c.fillColor,c.lineColor,c.lineThickness,m.Solid)}}_renderLineChart(t,e){const i=t.getCounts(),s=e.width/i.numSeries,r=e.x,a=e.y,n=a+e.height,o=t.getValueRange();for(let e=0;e<i.numSeries;e++){let h=this._normalizeValue(t.getValue(0,e),o);for(let d=1;d<i.numCats;d++){const i=t.getSeriesStyle(e,d),c=this._normalizeValue(t.getValue(d,e),o),l=r+(d-1)*s,u=n-(n-a)*h,g=r+d*s,p=n-(n-a)*c;this._painter.paintLine(l,u,g,p,i.lineColor||"000000",i.lineThickness,m.Solid),h=c}}}_renderBarChart(t,e){const i=t.getCounts(),s=e.width/((i.numCats+1)*(i.numSeries+1)),r=e.width/(i.numSeries+1),a=e.x+s,n=e.y,o=n+e.height,h=t.getValueRange();for(let e=0;e<i.numSeries;e++)for(let d=0;d<i.numCats;d++){const i=t.getSeriesStyle(e,d).fillColor||"000000",c=a+d*r+e*s,l=o-(o-n)*this._normalizeValue(t.getValue(d,e),h);this._painter.paintLine(c,o,c,l,i,s,m.Solid)}}_renderPieChart(t,e){const i=t.getCounts(),s=new D(e.x+e.width/2,e.y+e.height/2),r={min:0,max:t.getValueSum(0)},a=e.height/2,n=new xt(s,a,a);let o=rt.fromRotation(t.startAngle).subtract(rt.fromNormalized(.25));for(let e=0;e<i.numCats;e++){const i=t.getSeriesStyle(0,e).fillColor||"000000",h=rt.fromNormalized(this._normalizeValue(t.getValue(e,0),r)),d=new Ft;d.addSegmentMove(Et.fromPoint(s)),d.addSegmentLine(Et.fromPoint(n.pointAtAngle(o))),d.addSegmentArc(h.toRotation().toString(),o.toRotation().toString(),a.toString(),a.toString()),d.addSegmentLine(Et.fromPoint(s)),this._painter.paintPolygon(d.paths[0].buildPath(),i,void 0,void 0,m.Solid),o=o.add(h)}}_normalizeValue(t,e){return(t.numeric-e.min)/(e.max-e.min)}}class Bt{constructor(t){this._painter=t,this._chartRenderer=new Vt(this._painter)}renderDrawing(t){const e=t.picture;if(void 0!==e&&void 0!==e.bounds){const t=e.bounds;this._painter.paintPicture(t.x,t.y,t.width,t.height,e)}const i=t.chart;void 0!==i&&i.ensureLoaded().then(()=>{this._chartRenderer.renderChartSpace(i)});const s=t.shape;void 0!==s&&s.paths.forEach(t=>{const e=t.buildPath(),i=t.filledIn?s.fillColor:void 0,r=t.stroked?s.lineColor:void 0;this._painter.paintPolygon(e,i,r,1,m.Solid)})}}!function(t){t[t.None=0]="None",t[t.Square=1]="Square",t[t.Through=2]="Through",t[t.Tight=3]="Tight",t[t.TopAndBottom=4]="TopAndBottom"}(y||(y={}));class Rt{constructor(t,e){this.bounds=t,this.wrapping=e}getUsedWidth(){return this.bounds.sizeX}getHeight(){return this.bounds.sizeY}performLayout(t){const e=this.bounds.getBox(t),i=this.bounds.anchor===r.Floating;void 0!==this.picture&&(this.picture.bounds=e,this.picture.performLayout(t)),void 0!==this.chart&&(this.chart.bounds=e,this.chart.performLayout(t)),void 0!==this.shape&&this.shape.performLayout(e),this.lastXPos=0,this._addObstacle(t,e,i)}_addObstacle(t,e,i){const s=e.clone();this.wrapping===y.TopAndBottom&&(s.width=t.getWidth()),t.addObstacle(s,i)}}class Ot{constructor(t){this._painter=t}renderMathRun(t){t.equation.objects.forEach(t=>{t.render(this._painter)})}}class zt{constructor(t){this._size=void 0,this.equation=t}getUsedWidth(){return void 0===this._size&&(this._size=this.equation.objects.getSize()),this._size.width}getHeight(){return void 0===this._size&&(this._size=this.equation.objects.getSize()),this._size.height}performLayout(t){const e=this.previousXPos||t.getX();this.lastXPos=this.equation.objects.performLayout(t,e)}}class It{constructor(t){this._textRenderer=new Q(t),this._drawingRenderer=new Bt(t),this._mathRenderer=new Ot(t)}renderParagraph(t){let e=0;void 0!==t.numberingRun&&(this._textRenderer.renderTextRun(t.numberingRun),e=t.numberingRun.lastXPos),t.runs.forEach(t=>{t.previousXPos=e,t instanceof U?this._textRenderer.renderTextRun(t):t instanceof Rt?this._drawingRenderer.renderDrawing(t):t instanceof zt?this._mathRenderer.renderMathRun(t):console.log("Unknown Run type encountered during rendering, skipping it"),e=t.lastXPos})}}class $t{constructor(t){this._painter=new q(t),this._paragraphRenderer=new It(this._painter),this._tableRenderer=new Z(this._painter,this._paragraphRenderer)}renderDocument(t){const e=E.fromSection(t.section);return void 0!==t.section&&void 0!==t.section.pageWidth&&this._painter.setWidth(t.section.pageWidth),t.paragraphs.forEach(t=>{t.performLayout(e)}),t.paragraphs.forEach(t=>{t instanceof Y?this._paragraphRenderer.renderParagraph(t):this._tableRenderer.renderTable(t)}),e.getMaxY(!0)}clear(){this._painter.clear()}ensureHeight(t){this._painter.ensureHeight(t)}}class jt{constructor(t){this.doc=t}get document(){return this.doc}}class Xt{constructor(t){this.content={},this.package=t}static loadFromUrl(t){return new Promise((e,i)=>{var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="arraybuffer",s.onload=r=>{if(200===s.status){var a=s.response;Xt._loadFromArrayBuffer(a).then(t=>e(t)).catch(t=>i(t))}else i("File not found: "+t)},s.onerror=t=>{i(t)},s.send(null)})}static loadFromFile(t){return new Promise((e,i)=>{for(var s,r=0;s=t[r];r++)if(s.name.endsWith(".docx")){var a=new FileReader;a.onload=t=>{Xt._loadFromArrayBuffer(t.target.result).then(t=>e(t)).catch(t=>i(t))},a.readAsArrayBuffer(s);break}})}static _loadFromArrayBuffer(t){return new Promise((e,i)=>{t&&t.byteLength>0?(new JSZip).loadAsync(t).then(t=>{const s=new Xt(t);s._loadContentTypes().then(()=>{e(s)}).catch(t=>{i(t)})}).catch(t=>{i(t)}):i("No data received.")})}hasPart(t){return null!==this.package.file(t)}loadPartAsXml(t){return new Promise((e,i)=>{this.package.file(t).async("text").then(t=>{const i=(new DOMParser).parseFromString(t,"application/xml");e(new jt(i))}).catch(t=>{i(t)})})}loadPartAsBase64(t){return new Promise((e,i)=>{this.package.file(t).async("base64").then(t=>{e(t)}).catch(t=>{i(t)})})}loadPartAsBinary(t){return new Promise((e,i)=>{this.package.file(t).async("arraybuffer").then(t=>{e(t)}).catch(t=>{i(t)})})}getNamesByContentType(t){return this.content[t]}_loadContentTypes(){return new Promise((t,e)=>{this.loadPartAsXml("[Content_Types].xml").then(e=>{e.document.getRootNode().childNodes.forEach(t=>{if("Override"===t.nodeName){const e=B.getAttribute(t,"PartName"),i=B.getAttribute(t,"ContentType");if(void 0!==e&&void 0!==i){let t=i.replace("application/vnd.openxmlformats-","");t=t.replace("+xml",""),void 0===this.content[t]&&(this.content[t]=[]),this.content[t].push(e)}}}),t()}).catch(t=>{e(t)})})}}Xt.ChartContentType="officedocument.drawingxml.chart",Xt.WordDocumentContentType="officedocument.wordprocessing.document.main",Xt.WordFontTableContentType="officedocument.wordprocessing.fontTable",Xt.WordNumberingContentType="officedocument.wordprocessing.numbering",Xt.WordSettingsContentType="officedocument.wordprocessing.settings",Xt.WordStylesContentType="officedocument.wordprocessing.styles",Xt.ExtendedPropertiesContentType="officedocument.extended-properties",Xt.CorePropertiesContentType="package.core-properties",Xt.RelationshipsContentType="package.relationships",Xt.JpegContentType="image/jpeg",Xt.PngContentType="image/png";class Gt{constructor(t){this.named={},this.doc=t.document,this._docDefaultStyle=new $}parseContent(){if(void 0===this.named.Normal){const t=B.getFirstChildOfName(this.doc,"w:styles");void 0!==t&&t.childNodes.forEach(t=>{switch(t.nodeName){case"w:style":const e=B.getAttribute(t,"w:type");if(void 0!==e&&"numbering"!==e){const e=$.fromStyleNode(t),i=B.getAttribute(t,"w:styleId");void 0!==i&&(this.named[i]=e)}break;case"w:docDefaults":this._docDefaultStyle=$.fromDocDefaultsNode(t);break;case"w:latentStyles":break;default:console.log(`Don't know how to parse ${t.nodeName} during NamedStyle reading.`)}});for(const t in this.named)if(this.named.hasOwnProperty(t)){this.named[t].applyNamedStyles(this)}}}get docDefaults(){return this._docDefaultStyle}getNamedStyle(t){return this.named[t]}printDebugInfo(){for(const t in this.named)if(this.named.hasOwnProperty(t)){const e=this.named[t];console.log(`${t}: ${e.toString()}`),e.parStyle&&console.log(e.parStyle.toString()),e.runStyle&&console.log(e.runStyle.toString())}}}class Ht{constructor(t,e){this.sectionNode=e}get pageHeight(){return this.parseContent(),this._pageHeight}get pageWidth(){return this.parseContent(),this._pageWidth}get marginTop(){return this.parseContent(),this._marginTop}get marginLeft(){return this.parseContent(),this._marginLeft}get marginBottom(){return this.parseContent(),this._marginBottom}get marginRight(){return this.parseContent(),this._marginRight}parseContent(){void 0===this._pageWidth&&this.sectionNode.childNodes.forEach(t=>{switch(t.nodeName){case"w:pgSz":const e=B.getAttribute(t,"w:w");void 0!==e&&(this._pageWidth=V.convertTwipsToPixels(parseInt(e,10)));const i=B.getAttribute(t,"w:h");void 0!==i&&(this._pageHeight=V.convertTwipsToPixels(parseInt(i,10)));break;case"w:pgMar":const s=B.getAttribute(t,"w:top");void 0!==s&&(this._marginTop=V.convertTwipsToPixels(parseInt(s)));const r=B.getAttribute(t,"w:left");void 0!==r&&(this._marginLeft=V.convertTwipsToPixels(parseInt(r)));const a=B.getAttribute(t,"w:bottom");void 0!==a&&(this._marginBottom=V.convertTwipsToPixels(parseInt(a)));const n=B.getAttribute(t,"w:right");void 0!==n&&(this._marginRight=V.convertTwipsToPixels(parseInt(n)));break;case"w:textDirection":case"w:docGrid":case"w:pgNumType":case"w:formProt":case"w:type":case"w:headerReference":case"w:footerReference":case"w:titlePg":case"w:cols":break;default:console.log(`Don't know how to parse ${t.nodeName} during Section reading.`)}})}}class Wt{constructor(){this.borderTop=new J,this.borderBottom=new J,this.borderStart=new J,this.borderEnd=new J}}class Ut{constructor(){const t=V.convertTwipsToPixels(115);this.cellMarginBottom=0,this.cellMarginTop=0,this.cellMarginStart=t,this.cellMarginEnd=t}}class Yt{get justification(){return this._getValue(c.left,t=>t._justification)}set justification(t){this._justification=t}get identation(){return this._getValue(0,t=>t._identation)}set identation(t){this._identation=t}get borders(){return this._getValue(new Wt,t=>t._borders)}set borders(t){this._borders=t}get hasBordersDefined(){return void 0!==this._borders}get margins(){return this._getValue(new Ut,t=>t._margins)}set margins(t){this._margins=t}get cellSpacing(){return this._getValue(0,t=>t._cellSpacing)}set cellSpacing(t){this._cellSpacing=t}get columnSpan(){return this._getValue(1,t=>t._columnSpan)}set columnSpan(t){this._columnSpan=t}get rowSpanOrder(){return this._getValue(s.Only,t=>t._rowSpan)}set rowSpanOrder(t){this._rowSpan=t}get shading(){return this._getValue("",t=>t._shading)}set shading(t){this._shading=t}_getValue(t,e){let i=e(this);return void 0===i&&void 0!==this.higherStyle&&(i=e(this.higherStyle)),void 0===i&&(i=t),i}}class qt{constructor(t){this.docx=t,this.columns=[],this.rows=[],this.style=new Yt}getPars(){const t=[];return this.rows.forEach(e=>{t.push(...e.getPars())}),t}getHeight(){let t=0;return this.rows.forEach(e=>{t+=e.maxHeight||0}),t}performLayout(t){this.rows.forEach((t,e)=>{t.cells.forEach((t,i)=>{t.style.rowSpanOrder===s.First&&this._updateRowSpan(i,e)})}),this.rows.forEach(e=>{e.performLayout(t)}),this.rows.forEach((t,e)=>{t.cells.forEach((t,i)=>{t.numRowsInSpan>1&&void 0!==t.bounds&&(t.bounds.height=this._getHeightOfRowSpan(i,e))})})}_updateRowSpan(t,e){let i=1;for(let r=e;r<this.rows.length;r++){const e=this.rows[r+1];if(void 0===e||e.cells[t].style.rowSpanOrder!==s.Middle){this.rows[r].cells[t].style.rowSpanOrder=s.Last;break}e.cells[t].numRowsInSpan=0,i++}this.rows[e].cells[t].numRowsInSpan=i}_getHeightOfRowSpan(t,e){let i=0;const s=this.rows[e].cells[t].numRowsInSpan;for(let t=0;t<s;t++)i+=this.rows[e+t].maxHeight||0;return i}}class Jt{constructor(t,e){this.start=t,this.width=e}}class Zt{constructor(t){this.cells=[],this.table=t}setOrder(t){this.cells.forEach(e=>e.rowOrder=t)}getPars(){const t=[];return this.cells.forEach(e=>{t.push(...e.pars)}),t}performLayout(t){let e=0;this.cells.forEach(i=>{if(i.performLayout(t),i.style.rowSpanOrder===s.Only){const t=i.bounds.height;e=Math.max(t,e)}}),this.cells.forEach(t=>{t.style.rowSpanOrder===s.Only&&(t.bounds.height=e)}),this.maxHeight=e,t.advancePosition(e)}}class Qt{constructor(t,e,i){this.id=void 0,this.pars=[],this.numRowsInSpan=1,this._columns=void 0,this.style=e,this._allColumns=t,this._startColumnIndex=i}performLayout(t){const e=t.getX()+this._getColumns()[0].start,i=t.getY(),r=this.style.margins,a=this.style.borders;this.bounds=new L(e,i,this._getWidth(),0);const n=void 0===this.rowOrder?s.Only:this.rowOrder,o=this._getColumnOrder();this._contentBounds=this.bounds.clone().subtractBordersAndMargins(a,r,n,o);const h=this._performInnerLayout(t,this._contentBounds);this._contentBounds.height=h,this.bounds=this._contentBounds.addBordersAndMargins(a,r,n,o)}get numColumns(){return this._getColumns().length}_getColumns(){if(void 0===this._columns){const t=this.style.columnSpan;this._columns=this._allColumns.slice(this._startColumnIndex,this._startColumnIndex+t)}return this._columns}_getWidth(){let t=0;return this._getColumns().forEach(e=>{t+=e.width}),t}_performInnerLayout(t,e){const i=new E(e.left,e.right,e.top);return this.pars.forEach(t=>{t.performLayout(i)}),t.copyObstaclesFrom(i),i.getMaxY(!1)-e.top}_getColumnOrder(){let t=s.Middle;const e=this._allColumns.length;return 1===e?t=s.Only:0===this._startColumnIndex?t=s.First:this._startColumnIndex+this.numColumns===e&&(t=s.Last),t}}class Kt{static readTextRun(t,e,i){const s=new U([],new $),r=B.getFirstChildOfName(t,"w:rPr");return void 0!==r&&r.hasChildNodes()&&(s.style.runStyle=z.fromPresentationNode(r)),void 0!==e&&(s.style.parStyle=e),s.texts=Kt._getTexts(t),s.style.applyNamedStyles(i),s}static _getTexts(t){const e=[];return t.hasChildNodes()&&t.childNodes.forEach(t=>{switch(t.nodeName){case"w:t":const i=t.textContent;null!==i&&e.push(i);break;case"w:br":case"w:cr":e.push("\n");break;case"w:tab":e.push("\t")}}),e}}class te{constructor(t,e){this._pack=t,this._name=e}static fromPicNode(t,e){let i=void 0;const s=B.getFirstChildOfName(t,"pic:blipFill");if(void 0!==s){const t=B.getFirstChildOfName(s,"a:blip");if(void 0!==t){const s=B.getAttribute(t,"r:embed");let r=void 0;void 0!==e.relationships&&void 0!==s&&(r=e.relationships.getTarget(s),i=new te(e.pack,"word/"+r))}}return i}getImageUrl(){return new Promise((t,e)=>{if(void 0!==this._imageUrl)t(this._imageUrl);else{const i=this._name.split("."),s=i[i.length-1];let r=void 0,a=void 0;switch(s){case"jpg":case"jpeg":a="image/jpeg";break;case"png":a="image/png";break;case"gif":a="image/gif";break;case"bmp":a="image/bmp";break;case"webp":a="image/webp";break;case"tif":case"tiff":this._hasTiffSupport&&(r=this._getImageUrlForTiff);break;case"wmf":this._hasWmfSupport&&(r=this._getImageUrlForWmf);break;case"wmz":break;case"emf":this._hasEmfSupport&&(r=this._getImageUrlForEmf)}if(void 0!==a)this._pack.loadPartAsBase64(this._name).then(e=>{this._imageUrl=`data:${a};base64,${e}`,t(this._imageUrl)}).catch(t=>{e(t)});else if(void 0!==r&&void 0!==this.bounds){const i=this.bounds;this._pack.loadPartAsBinary(this._name).then(s=>{r(s,i).then(e=>{this._imageUrl=e,t(this._imageUrl)}).catch(t=>{e(t)})})}}})}performLayout(t){}get _hasTiffSupport(){return void 0!==UTIF}_getImageUrlForTiff(t,e){return new Promise((e,i)=>{const s=UTIF.decode(t);let r=s,a=0,n=r[0];s[0].subIFD&&(r=r.concat(s[0].subIFD));for(let t=0;t<r.length;t++){const e=r[t];if(null===e.t258||e.t258.length<3)continue;const i=e.t256*e.t257;i>a&&(a=i,n=e)}UTIF.decodeImage(t,n,s);const o=UTIF.toRGBA8(n),h=n.width,d=n.height;UTIF._xhrs.splice(0,1);var c=document.createElement("canvas");c.width=h,c.height=d;const l=c.getContext("2d");if(null!==l){const t=l.createImageData(h,d);for(let e=0;e<o.length;e++)t.data[e]=o[e];l.putImageData(t,0,0),e(c.toDataURL())}else i("Unable to create offscreen Canvas element")})}get _hasEmfSupport(){return void 0!==EMFJS}_getImageUrlForEmf(t,e){return new Promise((i,s)=>{EMFJS.loggingEnabled(!1);const r=new EMFJS.Renderer(t),a=e.width,n=e.height,o={width:a+"pt",height:n+"pt",xExt:a,yExt:n,mapMode:8},h=r.render(o);void 0!==h?i(h):s("Error during WMF parsing.")})}get _hasWmfSupport(){return void 0!==WMFJS}_getImageUrlForWmf(t,e){return new Promise((i,s)=>{WMFJS.loggingEnabled(!1);const r=new WMFJS.Renderer(t),a=e.width,n=e.height,o={width:a+"pt",height:n+"pt",xExt:a,yExt:n,mapMode:8},h=r.render(o);void 0!==h?i(h):s("Error during WMF parsing.")})}}class ee{constructor(t){this.series=[],this.space=t}getCounts(){return{numCats:this.series[0].categories.length,numValues:this.series[0].values.length,numSeries:this.series.length}}getValue(t,e){return this.series[e].values[t]}getValueRange(){if(void 0!==this._rangeMax&&void 0!==this._rangeMin)return{min:this._rangeMin,max:this._rangeMax};let t=Number.MIN_VALUE,e=Number.MAX_VALUE;this.series.forEach(i=>{i.values.forEach(i=>{const s=i.numeric;void 0!==s&&(t=Math.max(t,s),e=Math.min(e,s))})});const i=this.space.plotArea.valueAxis;return void 0!==i&&i.crossMode===v.AutoZero&&(e=0),this._rangeMin=e,this._rangeMax=t,{max:t,min:e}}setValueRange(t,e){this._rangeMin=t,this._rangeMax=e}getSeriesStyle(t,e){let i;const s=this.series[t].categories[e];return i=void 0!==s.style?s.style:this.series[t].style,i}}!function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(k||(k={}));class ie extends ee{constructor(t){super(t),this.orientation=k.Horizontal}}class se{constructor(){this.categories=[],this.values=[],this.style=new K,this.name=""}get hasNumericValues(){return this.values.length>0&&void 0!==this.values[0].numeric}get hasNumericCategories(){return this.categories.length>0&&void 0!==this.categories[0].numeric}}class re{constructor(){this.numeric=void 0,this.text=void 0,this.style=void 0}toString(){let t="";return void 0!==this.numeric?t=this.numeric.toString():void 0!==this.text&&(t=this.text),t}}class ae extends ee{constructor(t){super(t)}}class ne extends ee{constructor(t){super(t)}}class oe extends ee{constructor(t){super(t),this.startAngle=0}getValueSum(t){const e=this.series[t].values;let i=0;for(let t=0;t<e.length;t++){const s=e[t].numeric;void 0!==s&&(i+=s)}return i}}class he{static defineShape(t,e){this.creators[t]=()=>e.clone()}createShape(t){let e=void 0;const i=he.creators[t];return void 0!==i?e=i():console.log(`Not sure how to draw a ${t}.`),e}}he.creators={};class de{readShape(t){let e=new Ft,i=void 0,s=void 0;const r=B.getFirstChildOfName(t,"wps:spPr");return void 0!==r&&r.childNodes.forEach(t=>{switch(t.nodeName){case"a:custGeom":e=this._readCustomShape(t);break;case"a:prstGeom":e=this._readPresetShape(t);break;case"a:solidFill":i=this._readFillColor(t);break;case"a:ln":null!==t.firstChild&&(s=this._readFillColor(t.firstChild));break;case"a:noFill":i=void 0;break;case"a:xfrm":break;default:console.log(`Don't know how to parse ${t.nodeName} during Shape reading.`)}}),void 0!==e&&(e.lineColor=s,e.fillColor=i),e}readPath(t,e){let i=!0,s=!0;const r=B.getAttribute(t,"fill");void 0!==r&&(i="none"!==r);const a=B.getAttribute(t,"stroke");void 0!==a&&(s=B.attributeAsBoolean(a)),e.addPath(i,s),t.childNodes.forEach(t=>{if(t.nodeType===Node.ELEMENT_NODE)switch(t.nodeName){case"a:arcTo":case"arcTo":this._addAngle(t,e);break;case"a:moveTo":case"moveTo":const i=B.getFirstChildOfName(t,["pt","a:pt"]);void 0!==i?e.addSegmentMove(this._readPoint(i)):console.log("Invalid move-to path segment encountered.");break;case"a:lnTo":case"lnTo":const s=B.getFirstChildOfName(t,["pt","a:pt"]);void 0!==s?e.addSegmentLine(this._readPoint(s)):console.log("Invalid line-to path segment encountered.");break;case"a:cubicBezTo":case"cubicBezTo":this._addCubicBezier(t,e);break;case"a:quadBezTo":case"quadBezTo":this._addQuadBezier(t,e);break;case"a:close":case"close":e.addSegmentClose();break;default:console.log(`Unknown path segment ${t.nodeName} encountered during reading of Shape`)}})}_readPresetShape(t){let e=void 0;const i=B.getAttribute(t,"prst");return void 0!==i&&(e=de._presetFactory.createShape(i)),e}_readCustomShape(t){let e=void 0;const i=B.getFirstChildOfName(t,"a:pathLst");if(void 0!==i){const t=B.getFirstChildOfName(i,"a:path");if(void 0!==t){e=new Ft,this.readPath(t,e);const i=B.getAttribute(t,"w");void 0!==i&&(e.width=parseInt(i));const s=B.getAttribute(t,"h");void 0!==s&&(e.height=parseInt(s))}}return e}_readFillColor(t){let e=void 0;const i=t.firstChild;return null!==i&&(e=B.getStringValue(i)),e}_addAngle(t,e){const i=B.getAttribute(t,"swAng"),s=B.getAttribute(t,"stAng"),r=B.getAttribute(t,"wR"),a=B.getAttribute(t,"hR");void 0!==i&&void 0!==s&&void 0!==r&&void 0!==a&&e.addSegmentArc(i,s,r,a)}_addQuadBezier(t,e){const i=t.childNodes;if(3===i.length){const t=this._readPoint(i[1]),s=this._readPoint(i[0]);e.addSegmentQuadBezier(t,s)}}_addCubicBezier(t,e){const i=t.childNodes;if(3===i.length){const t=this._readPoint(i[1]),s=this._readPoint(i[0]),r=this._readPoint(i[2]);e.addSegmentCubicBezier(t,s,r)}}_readPoint(t){let e="0",i="0";const s=B.getAttribute(t,"x"),r=B.getAttribute(t,"y");return void 0!==s&&(e=s),void 0!==r&&(i=r),new Et(e,i)}}de._presetFactory=new he;class ce{static fromShapePropertiesNode(t){const e=new M;e.anchor=r.Floating;const i=B.getFirstChildOfName(t,"a:xfrm");if(void 0!==i){void 0!==B.getAttribute(i,"flipH")&&(e.flipHorizontal=!0),void 0!==B.getAttribute(i,"flipV")&&(e.flipVertical=!0);const t=B.getAttribute(i,"rot");void 0!==t&&(e.rotation=V.convertRotationToRadians(parseInt(t)));const s=B.getFirstChildOfName(i,"a:off");if(void 0!==s){const t=B.getAttribute(s,"x");void 0!==t&&(e.offsetX=V.convertEmuToPixels(parseInt(t)));const i=B.getAttribute(s,"y");void 0!==i&&(e.offsetY=V.convertEmuToPixels(parseInt(i)))}ce._readExtent(i,"a:ext",e)}return e}static fromInlineNode(t){const e=new M;return e.anchor=r.Inline,ce._readExtent(t,"wp:extent",e),ce._readHorizontalPosition(t,e),ce._readVerticalPosition(t,e),e}static fromAnchorNode(t){const e=new M;return e.anchor=r.Floating,ce._readExtent(t,"wp:extent",e),ce._readHorizontalPosition(t,e),ce._readVerticalPosition(t,e),e}static _readHorizontalPosition(t,e){const i=B.getFirstChildOfName(t,"wp:positionH");if(void 0!==i){const t=ce._readPositionReference(i);void 0!==t&&(e.referenceX=t);const s=ce._readPositionReferenceOffset(i);e.referenceOffsetX=s;const r=ce._readPositionAlignment(i);void 0!==r&&(e.alignX=r)}}static _readVerticalPosition(t,e){const i=B.getFirstChildOfName(t,"wp:positionV");if(void 0!==i){const t=ce._readPositionReference(i);void 0!==t&&(e.referenceY=t);const s=ce._readPositionReferenceOffset(i);e.referenceOffsetY=s;const r=ce._readPositionAlignment(i);void 0!==r&&(e.alignY=r)}}static _readPositionReference(t){let e=void 0;const i=B.getAttribute(t,"relativeFrom");if(void 0!==i)switch(i.toLowerCase()){case"character":case"line":e=a.Character;break;case"column":e=a.Column;break;case"leftmargin":case"topmargin":e=a.StartMargin;break;case"rightmargin":case"bottommargin":e=a.EndMargin;break;case"insidemargin":e=a.InsideMargin;break;case"outsidemargin":e=a.OutsideMargin;break;case"margin":e=a.Margin;break;case"page":e=a.Page;break;case"paragraph":e=a.Paragraph}return e}static _readPositionAlignment(t){let e=void 0;const i=B.getFirstChildOfName(t,"wp:align");if(void 0!==i&&null!==i.textContent)switch(i.textContent.toLowerCase()){case"left":case"top":e=n.Start;break;case"right":case"bottom":e=n.End;break;case"inside":e=n.Inside;break;case"outside":e=n.Outside;break;case"center":e=n.Center}return e}static _readPositionReferenceOffset(t){let e=0;const i=B.getFirstChildOfName(t,"wp:posOffset");return void 0!==i&&null!==i.textContent&&(e=V.convertEmuToPixels(parseInt(i.textContent))),e}static _readExtent(t,e,i){const s=B.getFirstChildOfName(t,e);if(void 0!==s){const t=B.getAttribute(s,"cx");void 0!==t&&(i.sizeX=V.convertEmuToPixels(parseInt(t)));const e=B.getAttribute(s,"cy");void 0!==e&&(i.sizeY=V.convertEmuToPixels(parseInt(e)))}}}class le{static readDrawingRun(t,e){let i=new M,s=y.None;const r=t.childNodes[0];"wp:anchor"===r.nodeName?(i=ce.fromAnchorNode(r),s=y.TopAndBottom):"wp:inline"===r.nodeName&&(i=ce.fromInlineNode(r));const a=new Rt(i,s),n=B.getFirstChildOfName(r,"a:graphic");if(void 0!==n){const t=B.getFirstChildOfName(n,"a:graphicData");void 0!==t&&this._readGraphicData(a,t,e)}return a}static _readGraphicData(t,e,i){e.childNodes.forEach(e=>{switch(e.nodeName){case"pic:pic":t.picture=te.fromPicNode(e,i);break;case"c:chart":const s=B.getAttribute(e,"r:id");if(void 0!==s&&void 0!==i.relationships){const e=i.relationships.getTarget(s);t.chart=this.readChartFromPart(i.pack.loadPartAsXml("word/"+e))}break;case"wps:wsp":t.shape=this.shapeReader.readShape(e);break;case"wpg:wgp":this._readGraphicData(t,e,i);break;case"wpg:grpSpPr":case"wpg:cNvGrpSpPr":break;default:console.log(`Don't know how to parse ${e.nodeName} during Drawing reading.`)}})}static readChartFromPart(t){const e=new st,i=new Promise((i,s)=>{t.then(t=>{this.readChartFromDocument(t.document,e),i()}).catch(t=>{s(t)})});return e.setPromise(i),e}static readChartFromDocument(t,e){const i=t.getRootNode().firstChild;return null!==i?class{static readChartFromNode(t,e){const i=B.getFirstChildOfName(t,"c:chart");return void 0!==i&&i.childNodes.forEach(t=>{switch(t.nodeName){case"c:spPr":e.style=this._readStyle(t);break;case"c:plotArea":this._readPlotArea(t,e);break;case"c:legend":this._readLegend(t,e)}}),e}static _readPlotArea(t,e){t.childNodes.forEach(t=>{switch(t.nodeName){case"c:areaChart":e.setAreaChart(this._readAreaChart(t,e));break;case"c:lineChart":e.setLineChart(this._readLineChart(t,e));break;case"c:barChart":e.setBarChart(this._readBarChart(t,e));break;case"c:pieChart":e.setPieChart(this._readPieChart(t,e));break;case"c:catAx":e.plotArea.categoryAxis=this._readChartAxis(t,e,!1);break;case"c:valAx":e.plotArea.valueAxis=this._readChartAxis(t,e,!0);break;case"c:spPr":e.plotArea.style=this._readStyle(t)}})}static _readLegend(t,e){const i=new it(e);t.childNodes.forEach(t=>{switch(t.nodeName){case"c:spPr":i.style=this._readStyle(t);break;case"c:legendPos":const e=B.getAttribute(t,"var");void 0!==e&&(i.position=this._parsePosition(e));break;case"c:overlay":const s=B.getBooleanValueFromNode(t,"var");void 0!==s&&(i.overlayOnPlot=s)}}),e.chartType===S.Pie&&(i.onlySeries=0),e.legend=i}static _readAreaChart(t,e){const i=new ne(e);return t.childNodes.forEach(t=>{if("c:ser"===t.nodeName){const e=this._readChartSeries(t);i.series.push(e)}}),i}static _readLineChart(t,e){const i=new ae(e);return t.childNodes.forEach(t=>{if("c:ser"===t.nodeName){const e=this._readChartSeries(t);i.series.push(e)}}),i}static _readBarChart(t,e){const i=new ie(e);return t.childNodes.forEach(t=>{if("c:ser"===t.nodeName){const e=this._readChartSeries(t);i.series.push(e)}}),i}static _readPieChart(t,e){const i=new oe(e);return t.childNodes.forEach(t=>{if("c:ser"===t.nodeName){const e=this._readChartSeries(t);i.series.push(e)}if("c:firstSliceAngle"===t.nodeName){const e=B.getAttribute(t,"val");void 0!==e&&(i.startAngle=parseInt(e))}}),i}static _readStyle(t){const e=new K;return t.childNodes.forEach(t=>{switch(t.nodeName){case"a:noFill":e.fillColor=void 0;break;case"a:solidFill":e.fillColor=this._readFillColor(t);break;case"a:ln":const i=t.firstChild;null!==i&&(e.lineColor=this._readFillColor(i))}}),e}static _readChartAxis(t,e,i){let s=_.Bottom,r=new K,a=f.None,n=f.None,o=new K,h=new K,d=w.Center,c=v.AutoZero,l=0;t.childNodes.forEach(t=>{let e=void 0;switch(t.nodeName){case"c:spPr":r=this._readStyle(t);break;case"c:majorTickMark":e=B.getAttribute(t,"val"),void 0!==e&&(a=this._parseTickMode(e));break;case"c:minorTickMark":e=B.getAttribute(t,"val"),void 0!==e&&(n=this._parseTickMode(e));break;case"c:majorGridlines":null!==t.firstChild&&(o=this._readStyle(t.firstChild));break;case"c:minorGridlines":null!==t.firstChild&&(h=this._readStyle(t.firstChild));break;case"c:axPos":e=B.getAttribute(t,"val"),void 0!==e&&(s=this._parsePosition(e));break;case"c:lblAlgn":e=B.getAttribute(t,"val"),void 0!==e&&(d=this._parseLabelAlignment(e));break;case"c:lblOffset":e=B.getAttribute(t,"val"),void 0!==e&&(l=V.convertTwipsToPixels(parseInt(e,10)));break;case"c:crosses":e=B.getAttribute(t,"val"),void 0!==e&&(c=this._parseCrossMode(e))}});const u=new et(e,r,s,a,n,l,i);return u.labelAlignment=d,u.crossMode=c,u.majorGridStyle=o,u.minorGridStyle=h,u}static _readChartSeries(t){const e=new se,i=[];return t.childNodes.forEach(t=>{const s=t.firstChild;switch(t.nodeName){case"c:tx":if(null!==s){const t=this._readStringReference(s);e.name=t[0]}break;case"c:cat":if(null!==s){const t=s.nodeName;if("c:strRef"===t){this._readStringReference(s).forEach(t=>{const i=new re;i.text=t,e.categories.push(i)})}else if("c:numRef"===t){this._readNumericReference(s).forEach(t=>{const i=new re;i.numeric=t,e.categories.push(i)})}else console.log("Don't know how to parse Chart Category from node: "+t)}break;case"c:val":if(null!==s){const t=s.nodeName;if("c:strRef"===t){this._readStringReference(s).forEach(t=>{const i=new re;i.text=t,e.values.push(i)})}else if("c:numRef"===t){this._readNumericReference(s).forEach(t=>{const i=new re;i.numeric=t,e.values.push(i)})}else console.log("Don't know how to parse Chart Value from node: "+t)}break;case"c:spPr":e.style=this._readStyle(t);break;case"c:dPt":const r=B.getNumberValueFromNode(t,"c:idx"),a=B.getFirstChildOfName(t,"c:spPr");void 0!==r&&void 0!==a&&(i[r]=this._readStyle(a));break;case"c:idx":case"c:order":case"c:invertIfNegative":case"c:dLbls":case"c:marker":case"c:smooth":case"c:explosion":break;default:console.log(`Don't know how to parse ${t.nodeName} during Chart Series reading.`)}}),i.forEach((t,i)=>{e.categories[i].style=t}),e}static _readStringReference(t){const e=[],i=B.getFirstChildOfName(t,"c:strCache");return void 0!==i&&i.childNodes.forEach(t=>{if("c:pt"===t.nodeName){const i=B.getAttribute(t,"idx"),s=B.getFirstChildOfName(t,"c:v");void 0!==i&&void 0!==s&&null!==s.textContent&&(e[parseInt(i,10)]=s.textContent)}}),e}static _readNumericReference(t){const e=[],i=B.getFirstChildOfName(t,"c:numCache");return void 0!==i&&i.childNodes.forEach(t=>{if("c:pt"===t.nodeName){const i=B.getAttribute(t,"idx"),s=B.getFirstChildOfName(t,"c:v");void 0!==i&&void 0!==s&&null!==s.textContent&&(e[parseInt(i,10)]=parseFloat(s.textContent))}}),e}static _readFillColor(t){let e=void 0;const i=t.firstChild;if(null!==i&&"a:srgbClr"===i.nodeName){const t=B.getAttribute(i,"val");void 0!==t&&(e=t)}return e}static _parseTickMode(t){let e=f.None;return"out"===t&&(e=f.Outwards),e}static _parsePosition(t){let e=_.Bottom;switch(t){case"t":e=_.Top;break;case"b":e=_.Bottom;break;case"l":e=_.Left;break;case"r":e=_.Right}return e}static _parseLabelAlignment(t){return w.Center}static _parseCrossMode(t){return v.AutoZero}}.readChartFromNode(i,e):(console.log("Failed to find chart"),new st)}}le.shapeReader=new de;class ue extends U{constructor(t){super([""],t.style||new $),this._style=t}performLayout(t){const e=this._getIndices(t);super.texts=[this._style.getPrefixText(e)],this._advanceIndex(t),super.performLayout(t)}_getIndices(t){const e=[],i=this._style.numId,s=this._style.level;if(void 0!==s){const r=s.index;for(let s=0;s<=r;s++)e.push(t.getNumbering(i,s))}else e.push(0);return e}_advanceIndex(t){const e=this._style.numId,i=this._style.level;let s=0;void 0!==i&&(s=i.index),t.advanceNumbering(e,s)}}class ge{constructor(t){this.objects=t}}class pe{constructor(){this.char="",this.hideSub=!1,this.hideSuper=!1}}class me{}class be extends me{constructor(){super(...arguments),this._list=[]}add(t){this._list.push(t)}unshift(t){this._list.unshift(t)}get(t){return this._list[t]}get length(){return this._list.length}forEach(t){return this._list.forEach(t)}getSize(){let t=new W(0,0);return this._list.forEach(e=>{t=t.addHorizontal(e.getSize())}),t}performLayout(t,e){let i=e;return this._list.forEach(e=>i=e.performLayout(t,i)),i}render(t){this._list.forEach(e=>e.render(t))}}class _e extends me{constructor(t,e){super(),this._char=t,this._style=e}getSize(){const t=this._style.lineSpacing;return new W(this._getWidth(),t)}performLayout(t,e){return this._pos=new D(t.getX()+e,t.getY()),e+this._getWidth()}render(t){void 0!==this._pos&&t.paintText(this._pos.x,this._pos.y,100,!1,this._char,this._style.color,c.left,this._style.fontFamily,this._style.fontSize,this._style.bold,this._style.italic)}_getWidth(){return X.averageCharWidth(this._style)*this._char.length}}class fe extends me{constructor(t,e,i,s){super(),this._sub=t,this._super=e,this._elem=i,this._char=new _e(s.char,new $),this._style=s}getSize(){let t=void 0!==this._elem?this._elem.getSize():new W(0,0),e=void 0!==this._super?this._super.getSize():new W(0,0),i=void 0!==this._sub?this._sub.getSize():new W(0,0);return e.addVertical(t).addVertical(i)}performLayout(t,e){var i;void 0===this._sub||this._style.hideSub||this._sub.performLayout(t,e),void 0===this._super||this._style.hideSuper||this._super.performLayout(t,e);let s=e;return s=this._char.performLayout(t,s)||s,s=(null===(i=this._elem)||void 0===i?void 0:i.performLayout(t,s))||s,s}render(t){var e;void 0===this._sub||this._style.hideSub||this._sub.render(t),void 0===this._super||this._style.hideSuper||this._super.render(t),this._char.render(t),null===(e=this._elem)||void 0===e||e.render(t)}}class we extends me{constructor(t,e,i){super(),this._elem=t,this._begin=new _e(e.beginChar,i),this._end=new _e(e.endChar,i)}getSize(){var t,e,i;let s=(null===(t=this._elem)||void 0===t?void 0:t.getSize())||new W(0,0);return s.addHorizontal((null===(e=this._begin)||void 0===e?void 0:e.getSize())||new W(0,0)),s.addHorizontal((null===(i=this._end)||void 0===i?void 0:i.getSize())||new W(0,0)),s}performLayout(t,e){var i,s,r;let a=e;return a=(null===(i=this._begin)||void 0===i?void 0:i.performLayout(t,a))||a,a=(null===(s=this._elem)||void 0===s?void 0:s.performLayout(t,a))||a,a=(null===(r=this._end)||void 0===r?void 0:r.performLayout(t,a))||a,a}render(t){var e,i,s;null===(e=this._begin)||void 0===e||e.render(t),null===(i=this._elem)||void 0===i||i.render(t),null===(s=this._end)||void 0===s||s.render(t)}}class ve extends me{constructor(t,e){super(),this._run=new U([t],new $(void 0,e)),this._run.inParagraph=s.Middle}getSize(){return this._run.getSize()}performLayout(t,e){return this._run.previousXPos=0!==e?e:void 0,this._run.performLayout(t),this._run.lastXPos}render(t){new Q(t).renderTextRun(this._run)}}class Se{constructor(){this.beginChar="",this.endChar=""}}class ye extends me{constructor(t,e,i){super(),this._numerator=t,this._denumerator=e,this.style=i}getSize(){let t,e;return t=void 0!==this._denumerator?this._denumerator.getSize():new W(0,0),e=void 0!==this._numerator?this._numerator.getSize():new W(0,0),t.addVertical(e,20)}performLayout(t,e){var i,s;const r=(null===(i=this._numerator)||void 0===i?void 0:i.performLayout(t,e))||e,a=(null===(s=this._denumerator)||void 0===s?void 0:s.performLayout(t,e))||e;return Math.max(r,a)}render(t){var e,i;null===(e=this._numerator)||void 0===e||e.render(t),null===(i=this._denumerator)||void 0===i||i.render(t)}}!function(t){t[t.NoBar=0]="NoBar",t[t.Bar=1]="Bar",t[t.Skewed=2]="Skewed",t[t.Linear=3]="Linear"}(x||(x={}));class ke{constructor(){this.type=x.NoBar}setType(t){switch(t){case"bar":this.type=x.Bar;break;case"skw":this.type=x.Skewed;break;case"lin":this.type=x.Linear;break;case"noBar":default:this.type=x.NoBar}}}!function(t){t[t.Inline=0]="Inline",t[t.Top=1]="Top",t[t.Center=2]="Center",t[t.Bottom=3]="Bottom",t[t.Inside=4]="Inside",t[t.Outside=5]="Outside"}(N||(N={})),function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right",t[t.Inside=3]="Inside",t[t.Outside=4]="Outside"}(T||(T={})),function(t){t[t.Single=0]="Single",t[t.OneAndAHalf=1]="OneAndAHalf",t[t.Two=2]="Two",t[t.Exactly=3]="Exactly",t[t.Multiple=4]="Multiple"}(C||(C={}));class xe{constructor(){this.baseJustification=N.Inline,this.hidePlaceholder=!1,this.rowSpacingRule=C.Single,this.rowSpacing=1,this.columnGapRule=C.Single,this.columnGap=1,this.columnMinimalWidth=1,this.columnStyles=void 0}setJustification(t){t}}class Ne extends me{constructor(t,e){super(),this.rows=t,this.style=e}getSize(){const t=this.rows.get(0).getSize().clone();return t.height=(t.height+20)*this.rows.length-20,t}performLayout(t,e){throw new Error("Method not implemented.")}render(t){throw new Error("Method not implemented.")}}class Te{}class Ce extends me{constructor(t,e,i){super(),this._functionName=t,this._elem=e,this.style=i}getSize(){let t,e;return t=void 0!==this._elem?this._elem.getSize():new W(0,0),e=void 0!==this._functionName?this._functionName.getSize():new W(0,0),e.addVertical(t)}performLayout(t,e){var i,s;let r=(null===(i=this._functionName)||void 0===i?void 0:i.performLayout(t,e))||e;return(null===(s=this._elem)||void 0===s?void 0:s.performLayout(t,r))||r}render(t){var e,i;null===(e=this._functionName)||void 0===e||e.render(t),null===(i=this._elem)||void 0===i||i.render(t)}}class Pe{constructor(){this.hideDegree=!1}}class Ae extends me{constructor(t,e,i){super(),this._degree=t,this._elem=e,this._radical=new _e("U0x221A",new $),this.style=i}getSize(){let t;return t=void 0!==this._elem?this._elem.getSize():new W(0,0),t.width+=20,t.height+=20,t}performLayout(t,e){var i,s,r;let a=e;return a=(null===(i=this._degree)||void 0===i?void 0:i.performLayout(t,a))||a,a=(null===(s=this._radical)||void 0===s?void 0:s.performLayout(t,a))||a,a=(null===(r=this._elem)||void 0===r?void 0:r.performLayout(t,a))||a,a}render(t){var e,i,s;null===(e=this._degree)||void 0===e||e.render(t),null===(i=this._radical)||void 0===i||i.render(t),null===(s=this._elem)||void 0===s||s.render(t)}}class De{constructor(){this.count=0,this.justification=T.Center}setJustification(t){switch(t){case"left":this.justification=T.Left;break;case"right":this.justification=T.Right;break;case"inside":this.justification=T.Inside;break;case"outside":this.justification=T.Outside;break;case"center":default:this.justification=T.Center}}}class Le{static readStructuredDocumentTag(t,e){const i=[],s=B.getFirstChildOfName(e,"w:sdtContent");return void 0!==s&&s.childNodes.forEach(e=>{switch(e.nodeName){case"w:p":i.push(Le.readParagraph(t,e))}}),i}static readParagraph(t,e){let i,r=void 0;const a=[],n=this.readStyle(t,e);void 0!==n&&void 0!==n.numStyle&&(i=new ue(n.numStyle));const o=n.clone();o.numStyle=void 0,e.childNodes.forEach(e=>{if(r=void 0,"w:hyperlink"===e.nodeName){const i=B.getAttribute(e,"r:id");void 0!==i&&(r=t.relationships.getTarget(i));const s=e.firstChild;null!==s&&(e=s)}if("w:r"===e.nodeName){e.childNodes.forEach(e=>{if("w:drawing"===e.nodeName){const i=le.readDrawingRun(e,t);a.push(i)}if("mc:AlternateContent"===e.nodeName){const i=B.getFirstChildOfName(e,"mc:Choice");if(void 0!==i){const e=B.getFirstChildOfName(i,"w:drawing");void 0!==e&&a.push(le.readDrawingRun(e,t))}}});const i=Kt.readTextRun(e,o,t.styles);i.inParagraph=s.Middle,i.linkTarget=r,a.push(i)}if("m:oMath"===e.nodeName){const t=class{static fromMathNode(t){const e=new ge(this._readMathElement(t));return new zt(e)}static _readNAryObject(t){let e=new pe,i=void 0,s=void 0,r=void 0,a=null;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:naryPr":e=this._readNAryStyle(t);break;case"m:sub":a=t.firstChild,null!==a&&(i=this._readMathElement(a));break;case"m:sup":a=t.firstChild,null!==a&&(s=this._readMathElement(a));break;case"m:e":r=this._readMathElement(t);break;default:console.log(`Don't know how to parse ${t.nodeName} during N-Ary Object reading.`)}}),new fe(i,s,r,e)}static _readNAryStyle(t){const e=new pe;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:chr":e.char=B.getStringValue(t)||"";break;case"m:subHide":e.hideSub=B.getBooleanValue(t)||!1;break;case"m:supHide":e.hideSuper=B.getBooleanValue(t)||!1;break;default:console.log(`Don't know how to parse ${t.nodeName} during N-Ary Style reading.`)}}),e}static _readDelimiterObject(t){let e=new Se,i=void 0;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:dPr":e=this._readDelimiterStyle(t);break;case"m:e":i=this._readMathElement(t);break;default:console.log(`Don't know how to parse ${t.nodeName} during Delimiter reading.`)}}),new we(i,e,new $)}static _readDelimiterStyle(t){const e=new Se;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:begChr":e.beginChar=B.getStringValue(t)||"";break;case"m:endChr":e.endChar=B.getStringValue(t)||"";break;default:console.log(`Don't know how to parse ${t.nodeName} during Delimiter style reading.`)}}),e}static _readFractionObject(t){let e=new ke,i=void 0,s=void 0;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:fPr":e=this._readFractionStyle(t);break;case"m:num":i=this._readMathElement(t);break;case"m:den":s=this._readMathElement(t);break;default:console.log(`Don't know how to parse ${t.nodeName} during Fraction reading.`)}}),new ye(i,s,e)}static _readFractionStyle(t){const e=new ke;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:type":e.setType(B.getStringValue(t));break;default:console.log(`Don't know how to parse ${t.nodeName} during Delimiter style reading.`)}}),e}static _readFunctionObject(t){let e=new Te,i=void 0,s=void 0;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:funcPr":e=this._readFunctionStyle(t);break;case"m:fName":i=this._readMathElement(t);break;case"m:e":s=this._readMathElement(t);break;default:console.log(`Don't know how to parse ${t.nodeName} during Fraction reading.`)}}),new Ce(i,s,e)}static _readFunctionStyle(t){const e=new Te;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:ctrlPr":break;default:console.log(`Don't know how to parse ${t.nodeName} during Delimiter style reading.`)}}),e}static _readMatrixObject(t){let e=new xe,i=new be;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:mPr":e=this._readMatrixStyle(t);break;case"m:mr":const s=new be;t.childNodes.forEach(t=>s.add(this._readMathElement(t))),i.add(s);break;default:console.log(`Don't know how to parse ${t.nodeName} during Fraction reading.`)}}),new Ne(i,e)}static _readMatrixStyle(t){const e=new xe;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:baseJc":e.setJustification(B.getStringValue(t));break;case"m:plcHide":e.hidePlaceholder=B.getBooleanValue(t)||!1;break;case"m:rSp":e.rowSpacing=B.getNumberValue(t)||1;break;case"m:rSpRule":e.rowSpacingRule=this._readMatrixSpacingRule(t);break;case"m:cSp":e.columnMinimalWidth=B.getNumberValue(t)||0;break;case"m:cGp":e.columnGap=B.getNumberValue(t)||1;break;case"m:cGpRule":e.columnGapRule=this._readMatrixSpacingRule(t);break;case"m:mcs":e.columnStyles=this._readMatrixColumnStyleList(t);break;case"m:ctrlPr":break;default:console.log(`Don't know how to parse ${t.nodeName} during Delimiter style reading.`)}}),e}static _readMatrixSpacingRule(t){return C.Single}static _readMatrixColumnStyleList(t){const e=[];return t.childNodes.forEach(t=>{"m:mc"===t.nodeName&&e.push(this._readMatrixColumnStyle(t))}),e}static _readMatrixColumnStyle(t){const e=new De;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:count":e.count=B.getNumberValue(t)||0;break;case"m:mcJc":e.setJustification(B.getStringValue(t));break;default:console.log(`Don't know how to parse ${t.nodeName} during Matrix Column Style reading.`)}}),e}static _readRadicalObject(t){let e=new Pe,i=void 0,s=void 0;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:radPr":e=this._readRadicalStyle(t);break;case"m:deg":i=this._readMathElement(t);break;case"m:e":s=this._readMathElement(t);break;default:console.log(`Don't know how to parse ${t.nodeName} during Radical reading.`)}}),new Ae(i,s,e)}static _readRadicalStyle(t){const e=new Pe;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:degHide":e.hideDegree=B.getBooleanValue(t)||!1;break;case"m:ctrlPr":break;default:console.log(`Don't know how to parse ${t.nodeName} during Delimiter style reading.`)}}),e}static _readRunObject(t){let e=void 0,i="";return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:t":i=t.textContent||"";break;case"w:rPr":e=z.fromPresentationNode(t);break;default:console.log(`Don't know how to parse ${t.nodeName} during Math Run reading.`)}}),new ve(i,e||new z)}static _readMathElement(t){const e=new be;return t.childNodes.forEach(t=>{switch(t.nodeName){case"m:e":e.add(this._readMathElement(t));break;case"m:nary":e.add(this._readNAryObject(t));break;case"m:d":e.add(this._readDelimiterObject(t));break;case"m:r":e.add(this._readRunObject(t));break;case"m:f":e.add(this._readFractionObject(t));break;case"m:m":e.add(this._readMatrixObject(t));break;case"m:func":e.add(this._readFunctionObject(t));break;case"m:rad":e.add(this._readRadicalObject(t));break;case"m:acc":case"m:bar":case"m:box":case"m:borderBox":case"m:eqArr":case"m:groupChr":case"m:limLow":case"m:limUpp":case"m:phant":case"m:sPre":case"m:sSub":case"m:sSubSup":case"m:sSup":console.log(`Math Object ${t.nodeName} not implemented yet`);break;default:console.log(`Unknown node ${t.nodeName} encountered during reading of Math Objects`)}}),e}}.fromMathNode(e);a.push(t)}});const h=i||a[0];if(1==a.length&&h instanceof U)h.inParagraph=s.Only;else if(a.length>0){h instanceof U&&(h.inParagraph=s.First);const t=a[a.length-1];t instanceof U&&(t.inParagraph=s.Last)}return new Y(a,i)}static readStyle(t,e){const i=B.getFirstChildOfName(e,"w:pPr");if(void 0!==i){const e=I.fromParPresentationNode(i);return e.applyNamedStyles(t.styles),e.applyNumberings(t.numberings),e}return new I}}class Me{constructor(t,e){this.pars=[],this.pack=t,this.part=e}parseContent(){if(0===this.pars.length){const t=B.getFirstChildOfName(this.part.document,"w:document");if(void 0!==t){const e=B.getFirstChildOfName(t,"w:body");void 0!==e&&e.childNodes.forEach(t=>{switch(t.nodeName){case"w:p":this.pars.push(Le.readParagraph(this,t));break;case"w:tbl":this.pars.push(class{static readTable(t,e){const i=new qt(t);let r=s.First;return e.childNodes.forEach(t=>{switch(t.nodeName){case"w:tr":const e=this.readTableRow(t,i);e.setOrder(r),i.rows.push(e),r=s.Middle;break;case"w:tblPr":i.style=this.readTableStyle(t);break;case"w:tblGrid":let a=0;t.childNodes.forEach(t=>{if("w:gridCol"===t.nodeName){const e=B.getAttribute(t,"w:w");if(void 0!==e){const t=V.convertTwipsToPixels(parseInt(e));i.columns.push(new Jt(a,t)),a+=t}}});break;default:console.log(`Don't know how to parse ${t.nodeName} during Table reading.`)}}),1===i.rows.length?i.rows[0].setOrder(s.Only):i.rows[i.rows.length-1].setOrder(s.Last),i}static readTableRow(t,e){const i=new Zt(e),s=new Yt;s.higherStyle=e.style;let r=0;return t.childNodes.forEach(t=>{if("w:tc"===t.nodeName){const a=this.readTableCell(t,e,s,r);r+=a.numColumns,i.cells.push(a)}}),i}static readTableCell(t,e,i,s){const r=new Yt,a=new Qt(e.columns,r,s);t.childNodes.forEach(t=>{switch(t.nodeName){case"w:p":const s=Le.readParagraph(e.docx,t);s.type=p.TableCell,a.pars.push(s);break;case"w:tcPr":this.readTableCellPresentation(t,i,r);break;default:console.log(`Don't know how to parse ${t.nodeName} during TableCell reading.`)}});const n=B.getAttribute(t,"w:id");return void 0!==n&&(a.id=n),a}static readTableCellPresentation(t,e,i){i.higherStyle=e,t.childNodes.forEach(t=>{switch(t.nodeName){case"w:tcW":const e=B.getAttribute(t,"w:w");void 0!==e&&(i.width=V.convertTwipsToPixels(parseInt(e)));break;case"w:gridSpan":const r=B.getStringValue(t);void 0!==r&&(i.columnSpan=parseInt(r));break;case"w:tcBorders":i.borders=this.readBorders(t);break;case"w:tcMar":i.margins=this.readCellMargins(t);break;case"w:shd":const a=B.getAttribute(t,"w:fill");void 0!==a&&(i.shading=a);break;case"w:vMerge":let n=s.Middle;const o=B.getStringValue(t);void 0!==o&&"restart"===o&&(n=s.First),i.rowSpanOrder=n;break;case"w:vAlign":break;default:console.log(`Don't know how to parse ${t.nodeName} during Table Cell Style reading.`)}})}static readBorders(t){const e=new Wt;return t.childNodes.forEach(t=>{switch(t.nodeName){case"w:left":case"w:start":e.borderStart=this.readTableBorder(t);break;case"w:right":case"w:end":e.borderEnd=this.readTableBorder(t);break;case"w:top":e.borderTop=this.readTableBorder(t);break;case"w:bottom":e.borderBottom=this.readTableBorder(t);break;case"w:insideH":e.borderHorizontal=this.readTableBorder(t);break;case"w:insideV":e.borderVertical=this.readTableBorder(t);break;default:console.log(`Don't know how to parse ${t.nodeName} during Table Borders reading.`)}}),e}static readCellMargins(t){const e=new Ut;return t.childNodes.forEach(t=>{switch(t.nodeName){case"w:left":const i=B.getAttribute(t,"w:w");void 0!==i&&(e.cellMarginStart=V.convertTwipsToPixels(parseInt(i)));break;case"w:start":const s=B.getAttribute(t,"w:w");void 0!==s&&(e.cellMarginStart=V.convertTwipsToPixels(parseInt(s)));break;case"w:right":const r=B.getAttribute(t,"w:w");void 0!==r&&(e.cellMarginEnd=V.convertTwipsToPixels(parseInt(r)));break;case"w:end":const a=B.getAttribute(t,"w:w");void 0!==a&&(e.cellMarginEnd=V.convertTwipsToPixels(parseInt(a)));break;case"w:top":const n=B.getAttribute(t,"w:w");void 0!==n&&(e.cellMarginTop=V.convertTwipsToPixels(parseInt(n)));break;case"w:bottom":const o=B.getAttribute(t,"w:w");void 0!==o&&(e.cellMarginBottom=V.convertTwipsToPixels(parseInt(o)));break;default:console.log(`Don't know how to parse ${t.nodeName} during Table Cell Margins reading.`)}}),e}static readTableBorder(t){const e=new J,i=B.getAttribute(t,"w:val");void 0!==i&&(e.type=this.parseTableBorderType(i));const s=B.getAttribute(t,"w:sz");void 0!==s&&(e.size=V.convertPointToPixels(parseInt(s,10)/4));const r=B.getAttribute(t,"w:space");void 0!==r&&(e.spacing=V.convertTwipsToPixels(parseInt(r,10)));const a=B.getAttribute(t,"w:color");return void 0!==a&&(e.color=a),e}static parseTableBorderType(t){let e=b.None;switch(t){case"single":e=b.Single;break;case"dashDotStroked":e=b.DashDotStroked;break;case"dashed":e=b.Dashed;break;case"dashSmallGap":e=b.DashSmallGap;break;case"dotDash":e=b.DotDash;break;case"dotDotDash":e=b.DotDotDash;break;case"dotted":e=b.Dotted;break;case"double":e=b.Double;break;case"doubleWave":e=b.DoubleWave;break;case"inset":e=b.Inset;break;case"outset":e=b.Outset;break;case"thick":e=b.Thick;break;case"thickThinLargeGap":e=b.ThickThinLargeGap;break;case"thickThinMediumGap":e=b.ThickThinMediumGap;break;case"thickThinSmallGap":e=b.ThickThinSmallGap;break;case"thinThickLargeGap":e=b.ThinThickLargeGap;break;case"thinThickMediumGap":e=b.ThinThickMediumGap;break;case"thinThickSmallGap":e=b.ThinThickSmallGap;break;case"thinThickThinLargeGap":e=b.ThinThickThinLargeGap;break;case"thinThickThinMediumGap":e=b.ThinThickThinMediumGap;break;case"thinThickThinSmallGap":e=b.ThinThickThinSmallGap;break;case"threeDEmboss":e=b.Emboss3D;break;case"threeDEngrave":e=b.Engrave3D;break;case"triple":e=b.Triple;break;case"wave":e=b.Wave;break;case"none":case"nil":default:e=b.None}return e}static readTableStyle(t){const e=new Yt;return t.childNodes.forEach(t=>{switch(t.nodeName){case"w:tblBorders":e.borders=this.readBorders(t);break;case"w:tblCellMar":e.margins=this.readCellMargins(t);break;case"w:jc":const i=B.getStringValue(t);void 0!==i&&(e.justification=c[i]);break;case"w:tblInd":const s=B.getAttribute(t,"w:w");void 0!==s&&(e.identation=V.convertTwipsToPixels(parseInt(s,10)));break;case"w:cellSpacing":const r=B.getAttribute(t,"w:w");void 0!==r&&(e.cellSpacing=V.convertTwipsToPixels(parseInt(r,10)));break;case"w:tblW":case"w:tblStyle":case"w:tblLook":break;default:console.log(`Don't know how to parse ${t.nodeName} during Table Style reading.`)}}),e}}.readTable(this,t));break;case"w:sectPr":this._section=new Ht(this,t);break;case"w:sdt":const e=Le.readStructuredDocumentTag(this,t);this.pars.push(...e);break;default:console.log(`Don't know how to parse ${t.nodeName} during Document reading.`)}})}}}performLayout(t){this.parseContent(),this.pars.forEach(e=>{e.performLayout(t)})}get relationships(){return this._rels}get styles(){return this._styles}get numberings(){return this._numberings}get coreProperties(){return this._coreProperties}setRelationships(t){this._rels=t}setNamedStyles(t){this._styles=t}setNumberings(t){this._numberings=t}setCoreProperties(t){this._coreProperties=t}get paragraphs(){return this.pars}get section(){return this._section}}!function(t){t.none="none",t.bullet="bullet",t.cardinalText="cardinalText",t.chicago="chicago",t.decimal="decimal",t.decimalEnclosedCircle="decimalEnclosedCircle",t.decimalEnclodedFullStop="decimalEnclosedFullstop",t.decimalEnclosedParentheses="decimalEnclosedParen",t.decimalZero="decimalZero",t.lowerLetter="lowerLetter",t.lowerRoman="lowerRoman",t.ordinalText="ordinalText",t.upperLetter="upperLetter",t.upperRoman="upperRoman"}(P||(P={})),function(t){t.nothing="nothing",t.space="space",t.tab="tab"}(A||(A={}));class Fe{constructor(t){this.style=new $,this.format=P.none,this.start=void 0,this.suffix=A.tab,this.text=void 0,this._romanCodes=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"]],this.index=t}static fromLevelNode(t,e){const i=B.getAttribute(e,"w:ilvl");if(void 0===i)return;const s=parseInt(i,10),r=new Fe(s);return r.style=$.fromStyleNode(e),r.style.applyNamedStyles(t),e.childNodes.forEach(t=>{switch(t.nodeName){case"w:start":r.start=B.getNumberValue(t);break;case"w:suff":const e=B.getStringValue(t);void 0!==e&&(r.suffix=A[e]);break;case"w:numFmt":const i=B.getStringValue(t);void 0!==i&&(r.format=P[i]);break;case"w:lvlText":r.text=B.getStringValue(t);break;case"w:lvlJc":case"w:pPr":case"w:rPr":case"w:pStyle":break;default:console.log(`Don't know how to parse ${t.nodeName} during Numbering Level reading.`)}}),r}getText(t){return this.getFormatted(t)}getFormatted(t){let e;switch(this.format){case P.bullet:e="&#x2002;",e="-";break;case P.none:e="";break;case P.decimal:e=t.map(t=>t.toString()).join(".");break;case P.lowerLetter:e=t.map(this._toDecimal).join(".");break;case P.upperLetter:e=t.map(this._toDecimal).join(".").toLocaleUpperCase();break;case P.lowerRoman:e=t.map(this._toRoman).join(".");break;case P.upperRoman:e=t.map(this._toRoman).join(".").toLocaleUpperCase();break;default:console.log("Don't know how to render numbering format "+this.format),e="-"}return e}_toDecimal(t){return t>26?this._toDecimal(t/26)+this._toDecimal(t%26):String.fromCharCode(96+Math.floor(t))}_toRoman(t){var e="",i=t.toString().split("").reverse();for(let t=0;t<i.length;t++)e=this._romanCodes[t][parseInt(i[t])]+e;return e}}class Ee{constructor(){this._levels=[]}static fromAbstractNumNode(t,e){const i=new Ee;return e.childNodes.forEach(e=>{if("w:lvl"===e.nodeName){const s=Fe.fromLevelNode(t,e);void 0!==s&&(i._levels[s.index]=s)}}),i}getLevel(t){return this._levels[t]}}class Ve{constructor(t){this._numberings=[],this.doc=t.document}parseContent(t){if(0===this._numberings.length){const e=B.getFirstChildOfName(this.doc,"w:numbering");if(void 0!==e){const i=[];e.childNodes.forEach(e=>{if("w:abstractNum"===e.nodeName){const s=B.getAttribute(e,"w:abstractNumId");if(void 0!==s){const r=Ee.fromAbstractNumNode(t,e);i[parseInt(s)]=r}}}),e.childNodes.forEach(t=>{if("w:num"===t.nodeName){const e=B.getAttribute(t,"w:numId"),s=B.getNumberValueFromNode(t,"w:abstractNumId");void 0!==e&&void 0!==s&&(this._numberings[parseInt(e)]=i[s])}})}}}getNumberingById(t){return this._numberings[t]}}class Be{constructor(){this.relations={}}static fromDocument(t){const e=new Be;return t.getRootNode().childNodes.forEach(t=>{t.childNodes.forEach(t=>{if("Relationship"===t.nodeName){const i=B.getAttribute(t,"Id"),s=B.getAttribute(t,"Target"),r=B.getAttribute(t,"Type");void 0!==i&&void 0!==s&&void 0!==r&&(e.relations[i]={target:s,type:r})}})}),e}getTarget(t){return this.relations[t].target}}class Re{constructor(){this._shapeReader=new de}readPresetShapeDefinitions(t){t.getRootNode().firstChild.childNodes.forEach(t=>{t.nodeType===Node.ELEMENT_NODE&&this.readPresetShapeDefinition(t)})}readPresetShapeDefinition(t){const e=new Ft;t.childNodes.forEach(t=>{switch(t.nodeName){case"avLst":case"gdLst":this._readShapeGuideList(t,e);break;case"pathLst":this._readPathList(t,e);break;case"ahLst":case"rect":case"cxnLst":case"#text":break;default:console.log(`Unknown node ${t.nodeName} encountered during reading of Shape definitions`)}}),he.defineShape(t.nodeName,e)}_readShapeGuideList(t,e){t.childNodes.forEach(t=>{t.nodeType===Node.ELEMENT_NODE&&this._readShapeGuide(t,e)})}_readShapeGuide(t,e){const i=B.getAttribute(t,"fmla"),s=B.getAttribute(t,"name");void 0!==i&&void 0!==s&&e.guide.addFormula(i,s)}_readPathList(t,e){t.childNodes.forEach(t=>{t.nodeType===Node.ELEMENT_NODE&&this._shapeReader.readPath(t,e)})}}class Oe{constructor(){this.creator=void 0,this.created=void 0,this.description=void 0,this.language=void 0,this.lastModifiedBy=void 0,this.lastModified=void 0,this.lastPrinted=void 0,this.revision=void 0,this.subject=void 0,this.title=void 0,this.keywords=void 0}static fromDocument(t){const e=new Oe;return t.getRootNode().childNodes.forEach(t=>{t.childNodes.forEach(t=>{const i=null===t.textContent?"":t.textContent;switch(t.nodeName){case"dcterms:created":e.created=Oe._parseDateString(i);break;case"dc:creator":e.creator=i;break;case"dc:description":e.description=i;break;case"dc:language":e.language=i;break;case"cp:lastModifiedBy":e.lastModifiedBy=i;break;case"dcterms:modified":e.lastModified=Oe._parseDateString(i);break;case"cp:lastPrinted":e.lastPrinted=Oe._parseDateString(i);break;case"cp:revision":e.revision=parseInt(i);break;case"dc:subject":e.subject=i;break;case"dc:title":e.title=i;break;case"cp:keywords":e.keywords=i;break;default:console.log(`Unknown core property ${t.nodeName} encountered during reading.`)}})}),e}static _parseDateString(t){const e=parseInt(t.substr(0,4)),i=t.length<=4?0:parseInt(t.substr(5,2)),s=t.length<=7?0:parseInt(t.substr(8,2));let r=0,a=0,n=0;return t.length>10&&(r=parseInt(t.substr(11,2)),a=parseInt(t.substr(14,2)),n=parseInt(t.substr(17,2))),new Date(Date.UTC(e,i-1,s,r,a,n,0))}}class ze{constructor(t){this.renderer=new $t(t)}loadDocxFromUrl(t){this._init(),Xt.loadFromUrl(t).then(t=>{this._loadFromPackage(t)}).catch(e=>{console.log(`Failed to load ${t}: ${e}`)})}loadDocxFromFiles(t){this._init(),Xt.loadFromFile(t).then(t=>{this._loadFromPackage(t)})}_loadFromPackage(t){t.loadPartAsXml("word/_rels/document.xml.rels").then(e=>{const i=Be.fromDocument(e.document);t.loadPartAsXml("word/styles.xml").then(e=>{const s=new Gt(e);s.parseContent(),t.loadPartAsXml("docProps/core.xml").then(e=>{const r=Oe.fromDocument(e.document);t.hasPart("word/numbering.xml")?t.loadPartAsXml("word/numbering.xml").then(e=>{const a=new Ve(e);a.parseContent(s),this._loadDocument(t,i,s,r,a)}):this._loadDocument(t,i,s,r,void 0)})})})}_loadDocument(t,e,i,s,r){t.loadPartAsXml("word/document.xml").then(a=>{const n=new Me(t,a);n.setRelationships(e),n.setNamedStyles(i),n.setCoreProperties(s),void 0!==r&&n.setNumberings(r),n.parseContent();const o=this.renderer.renderDocument(n);this.renderer.ensureHeight(o)})}_init(){V.init(),this.renderer.clear(),B.loadFromUrl("./presetShapeDefinitions.xml").then(t=>{(new Re).readPresetShapeDefinitions(t)}).catch(()=>{console.log("Unable to load preset shapes")})}}}])}));
//# sourceMappingURL=potlood.min.js.map